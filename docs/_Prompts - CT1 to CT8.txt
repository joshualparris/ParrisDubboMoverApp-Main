_Prompt 1


Here’s a beefed-up CT1 you can paste straight into Cursor / VS Code 👇
CT1 – Project Scaffolding & Base Architecture


You are an expert full-stack TypeScript engineer.


Create a new monorepo-style project called `pdm-parris-dubbo-mover` that will eventually implement the “ParrisDubboMover (PDM)” app described in a separate design document. This is **CT1**, the first step; later prompts (CT2, CT3, etc.) will add the full data model, modules, and features. For now, focus on clean scaffolding and a solid developer experience.


## High-level goals


- Monorepo with:
  - A **TypeScript React** frontend (Vite) as a single-page app.
  - A **Node.js + Express + TypeScript + SQLite** backend API.
- Simple dev experience: **one command** from the repo root to start both client and server.
- Working health-check:
  - Backend: `GET /api/health` returns JSON `{ "status": "ok" }`.
  - Frontend: Home page shows “PDM App running” and can successfully call `/api/health` via the dev server.


Use **Node 20+** and **React 18+**.


---


## 1. Repo structure


Create this structure:


- `pdm-parris-dubbo-mover/`
  - `package.json`
  - `README.md`
  - `client/`  (React + Vite + TS)
  - `server/`  (Node + Express + TS)
  - `.gitignore`
  - (any config files like `.eslintrc`, `prettier.config`, etc. if you add them)


### Root `package.json`


- Use workspaces or simple scripts that delegate to `client` and `server`.
- Include at least these scripts:


  - `"install:all"` – runs install in both `client` and `server` (e.g. using `npm run` or `npm --workspace` depending on how you structure it).
  - `"dev"` – runs **both** client and server concurrently.
  - `"dev:client"` – runs the Vite dev server.
  - `"dev:server"` – runs the Express server in watch mode.
  - `"build"` – builds client and server (can be placeholders for now, but wire them up).
  - `"lint"` – placeholder or basic lint (optional, but preferred).


- Use `concurrently` (or similar) so that `npm run dev` from the root starts both processes.


---


## 2. Backend (server)


Create a TypeScript Express server in `server/`:


### Dependencies (server)


- Runtime:
  - `express`
  - `better-sqlite3` (preferred) **or** `sqlite3` (pick one and use it consistently)
  - `cors`
- Dev:
  - `typescript`
  - `ts-node-dev` **or** `nodemon` + `ts-node`
  - `@types/node`
  - `@types/express`


### Server layout


Inside `server/`, create something like:


- `package.json`
- `tsconfig.json`
- `src/`
  - `index.ts`          (entry point)
  - `app.ts`            (Express app setup)
  - `routes/health.ts`  (health route)
  - `db/`
    - `index.ts`        (SQLite connection helper)


### Behaviour


1. **Express app basics**
   - Create an Express app in `app.ts`.
   - Use JSON body parsing middleware.
   - Enable CORS (allow requests from `http://localhost:3000` during dev).
   - Mount routes under `/api`.


2. **Health route**
   - In `routes/health.ts`, define a router that exposes:
     - `GET /api/health` → returns status code `200` and JSON:
       ```json
       { "status": "ok" }
       ```


3. **Server entry**
   - In `index.ts`, import the app and start an HTTP server on port **4000** by default.
   - Read the port from `process.env.PORT || 4000`.
   - Log a clear message when the server is running (e.g. `Server listening on http://localhost:4000`).


4. **SQLite setup**
   - In `db/index.ts`, set up a simple connection to a SQLite database file, for example:
     - DB file: `./data/pdm.db` (create a `data/` folder if needed).
   - Export a reusable database instance (e.g. with `better-sqlite3`).
   - For CT1, it’s enough to:
     - Open the DB.
     - Optionally create a simple table (e.g. `app_meta` with a single row) just to verify the DB schema can be created.
   - Don’t implement the full data model yet; that will be done in later CT prompts.


5. **Server scripts**


- `server/package.json` should include:


  - `"dev"` – runs the server in watch mode using `ts-node-dev` or `nodemon` (e.g. `ts-node-dev --respawn src/index.ts`).
  - `"build"` – compiles TypeScript to JavaScript (e.g. `tsc`).
  - `"start"` – runs the compiled JavaScript (e.g. `node dist/index.js`).


- `tsconfig.json` should:
  - Target a modern ECMAScript (e.g. ES2020).
  - Output compiled JS to `dist/`.
  - Use `"module": "commonjs"` or `"module": "esnext"` depending on how you configure Node; just make it consistent and working.


---


## 3. Frontend (client)


Create a React + TypeScript app in `client/` using **Vite**.


### Dependencies (client)


- Runtime:
  - `react`
  - `react-dom`
  - `react-router-dom`
- Dev:
  - `vite`
  - `@vitejs/plugin-react-swc` (or standard React plugin)
  - `typescript`
  - `@types/react`
  - `@types/react-dom`


### Vite setup


- Configure the dev server to run on port **3000**.
- Configure a **proxy** so that requests to `/api` are forwarded to the backend on `http://localhost:4000`.  
  Example: in `vite.config.ts`, set `server.proxy['/api']` appropriately.


This ensures `http://localhost:3000/api/health` during dev reaches the Express server.


### Basic app layout


Implement a minimal but realistic starting point:


- `client/src/main.tsx` (entry)
- `client/src/App.tsx`
- `client/index.html`


In `App.tsx`:


- Use `react-router-dom` with a basic `<BrowserRouter>`.
- For now, create a very simple route structure, anticipating future modules:
  - `/` – Home / Dashboard
  - Optionally stub routes like `/housing`, `/work`, `/childcare`, `/health`, etc. with placeholder `<div>`s.


On the **Home page**:


- Render a heading or main text: **“PDM App running”**.
- Add a small component that:
  - On mount (e.g. `useEffect`), calls `GET /api/health` using `fetch`.
  - Displays the returned status text somewhere on the page (e.g. “API Health: ok” or an error message if the call fails).


Make sure TypeScript types are correct and there are no compile errors.


---


## 4. Tooling & DX (optional but preferred)


If time and complexity allow, set up:


- Basic ESLint + Prettier config for both client and server:
  - Shared base rules (e.g. `@typescript-eslint`).
- A `.gitignore` in the repo root that ignores:
  - `node_modules`
  - `dist`
  - `build`
  - `*.log`
  - SQLite DB files in `server/data/` (except maybe a sample seed if you choose to include one).


These are optional for CT1 but improve the experience.


---


## 5. README


Create a `README.md` at the repo root with:


- Project name: **ParrisDubboMover (PDM)**.
- Short description:
  - E.g. “A browser-based mission control app for the Parris family’s Bendigo → Dubbo move.”
- Tech stack summary:
  - React + TypeScript + Vite frontend
  - Node + Express + TypeScript backend
  - SQLite via better-sqlite3 (or sqlite3)
- Setup instructions (explicit):


  1. `cd pdm-parris-dubbo-mover`
  2. `npm run install:all` (or describe the exact install commands)
  3. `npm run dev`
  4. Visit `http://localhost:3000` in the browser.


- Quick verification steps:
  - Home page shows “PDM App running”.
  - `http://localhost:3000/api/health` returns `{ "status": "ok" }` in the browser or via curl/Postman.


---


## 6. Acceptance criteria


For CT1 to be considered complete:


1. From the repo root, I can run a **single command** (`npm run dev` or similar) that:
   - Starts the backend on port **4000**.
   - Starts the Vite dev server on port **3000**, with proxying of `/api` to `http://localhost:4000`.
2. Visiting `http://localhost:3000/` in a browser shows:
   - A React app with text “PDM App running”.
   - A visible indicator of the API health check (e.g. “API Health: ok”).
3. Visiting `http://localhost:3000/api/health` in a browser returns:
   - HTTP 200
   - JSON `{ "status": "ok" }`.
4. The SQLite database file is created and opened successfully by the backend without runtime errors.
5. There are no TypeScript compile errors in either `client` or `server`.
6. The repo has a clear structure and a `README.md` documenting how to install and run the project.


Please generate **all necessary code files in full** (not just descriptions), so that I can create the directory structure, paste each file where it belongs, run `npm install` as described, and immediately start the app with the single dev command.


________________


Here’s CT2 as a drop-in prompt for your autocoder 👇
CT2 – Database Schema & Data Access Layer (SQLite)


You are an expert full-stack TypeScript engineer.


The project from **CT1** already exists as a monorepo called `pdm-parris-dubbo-mover` with:


- `server/` – Node.js + Express + TypeScript backend using SQLite via `better-sqlite3` (or `sqlite3`).
- `client/` – React + TypeScript + Vite frontend.
- Working `GET /api/health` endpoint.


In this task, **do not break any existing functionality** (especially `/api/health`).  
Your job is to implement the **database schema + basic data access layer** in the backend, based on the PDM design, so future CT prompts can build APIs and UI on top.


---


## 1. Stack & assumptions


- Use the **existing SQLite setup** from CT1 (`better-sqlite3` preferred, or `sqlite3` if that’s what’s already there).
- No heavy ORM (no Prisma, no TypeORM). Use **plain SQL + small helper functions**.
- Implement a **simple migration/init system** that:
  - Runs on server startup.
  - Creates tables with `CREATE TABLE IF NOT EXISTS` statements.
  - Seeds essential baseline data (domains and a default user).


---


## 2. Tables to create (schema design)


Create these tables in SQLite, with sensible defaults and constraints.


Use **INTEGER PRIMARY KEY AUTOINCREMENT** for IDs, and **TEXT** for string-like fields. Use **ISO 8601 strings** (TEXT) for dates/datetimes (e.g. `2026-01-15T09:00:00Z` or local time).


### 2.1 `users`


Represents the (single) app user, but design for possible multi-user later.


Fields:


- `id` INTEGER PRIMARY KEY AUTOINCREMENT
- `name` TEXT NOT NULL
- `email` TEXT
- `created_at` TEXT NOT NULL
- `updated_at` TEXT NOT NULL


Seed one default user:


- `id = 1`, `name = 'Josh Parris'`, `email` can be null or a placeholder.


### 2.2 `domains`


Logical groupings/modules (Housing, Health, etc.).


Fields:


- `id` INTEGER PRIMARY KEY AUTOINCREMENT
- `name` TEXT NOT NULL       -- Human label, e.g. "Housing & Rentals"
- `slug` TEXT NOT NULL UNIQUE  -- Machine-friendly, e.g. "housing", "health_ms"
- `created_at` TEXT NOT NULL
- `updated_at` TEXT NOT NULL


Seed these records (IDs can be fixed or let AUTOINCREMENT choose, but slugs must match exactly):


1. `name = 'Housing & Rentals', slug = 'housing'`
2. `name = 'Kristy’s Work & Career', slug = 'kristy_work'`
3. `name = 'Childcare & Schooling', slug = 'childcare_schooling'`
4. `name = 'Health & MS / Neurology', slug = 'health_ms'`
5. `name = 'Josh’s Work at DCS', slug = 'dcs_work'`
6. `name = 'NDIS & Therapies (Sylvie)', slug = 'ndis_therapies'`
7. `name = 'Licensing, Rego & WWCC', slug = 'licensing_rego'`
8. `name = 'Utilities & Services', slug = 'utilities_services'`
9. `name = 'Packing, Logistics & Travel', slug = 'packing_logistics'`
10. `name = 'Church & Community', slug = 'church_community'`
11. `name = 'What Should I Do Next', slug = 'next_actions'`


### 2.3 `documents`


Uploaded docs (PDF, DOCX, images etc.) with extracted text.


Fields:


- `id` INTEGER PRIMARY KEY AUTOINCREMENT
- `user_id` INTEGER NOT NULL REFERENCES users(id)
- `title` TEXT NOT NULL                 -- user-friendly title
- `original_filename` TEXT              -- raw filename
- `source_path` TEXT                    -- path on disk if stored locally
- `content_text` TEXT                   -- extracted text (may be large)
- `uploaded_at` TEXT NOT NULL
- `updated_at` TEXT NOT NULL


No seed data required yet.


### 2.4 `properties`


Houses: Bendigo home + Dubbo rental candidates.


Fields:


- `id` INTEGER PRIMARY KEY AUTOINCREMENT
- `user_id` INTEGER NOT NULL REFERENCES users(id)
- `address` TEXT NOT NULL
- `type` TEXT NOT NULL       -- e.g. 'bendigo_home', 'dubbo_rental_candidate', 'dubbo_rental_confirmed'
- `rent_weekly` REAL         -- weekly rent in AUD (for rentals)
- `status` TEXT              -- e.g. 'interested', 'applied', 'secured', 'handed_over'
- `notes` TEXT
- `created_at` TEXT NOT NULL
- `updated_at` TEXT NOT NULL


Optionally seed one `properties` row for 53 Buckland St (type `bendigo_home`).


### 2.5 `job_options`


Kristy’s job options in Dubbo.


Fields:


- `id` INTEGER PRIMARY KEY AUTOINCREMENT
- `user_id` INTEGER NOT NULL REFERENCES users(id)
- `employer` TEXT NOT NULL       -- 'Tresillian Dubbo', 'NSW Health', etc.
- `role` TEXT                    -- 'Registered Nurse', etc.
- `hours_per_week` REAL          -- approximate hours
- `pay_rate_hourly` REAL         -- approximate pay
- `status` TEXT                  -- 'idea', 'applied', 'offer', 'accepted', 'rejected'
- `pros` TEXT                    -- freeform notes
- `cons` TEXT                    -- freeform notes
- `notes` TEXT
- `created_at` TEXT NOT NULL
- `updated_at` TEXT NOT NULL


No seed data required; will be user-entered later.


### 2.6 `childcare_options`


Daycare/preschool options for Elias and Sylvie.


Fields:


- `id` INTEGER PRIMARY KEY AUTOINCREMENT
- `user_id` INTEGER NOT NULL REFERENCES users(id)
- `name` TEXT NOT NULL             -- 'Imagine Childcare Blueridge', etc.
- `type` TEXT NOT NULL             -- 'daycare', 'preschool', 'combined'
- `location` TEXT                  -- address or area
- `min_age_months` INTEGER         -- age eligibility
- `max_age_months` INTEGER
- `daily_fee` REAL                 -- approximate daily fee
- `status` TEXT                    -- 'idea', 'waitlisted', 'offered', 'enrolled', 'rejected'
- `notes` TEXT
- `created_at` TEXT NOT NULL
- `updated_at` TEXT NOT NULL


### 2.7 `providers`


Generic providers: neurologists, GPs, OTs, property manager, etc.


Fields:


- `id` INTEGER PRIMARY KEY AUTOINCREMENT
- `user_id` INTEGER NOT NULL REFERENCES users(id)
- `name` TEXT NOT NULL
- `type` TEXT NOT NULL             -- 'neurologist', 'gp', 'ot', 'speech', 'psych', 'property_manager', 'church', etc.
- `phone` TEXT
- `email` TEXT
- `address` TEXT
- `notes` TEXT
- `created_at` TEXT NOT NULL
- `updated_at` TEXT NOT NULL


### 2.8 `appointments`


Fixed-time events: medical, psych, move-related, first day at DCS, etc.


Fields:


- `id` INTEGER PRIMARY KEY AUTOINCREMENT
- `user_id` INTEGER NOT NULL REFERENCES users(id)
- `provider_id` INTEGER REFERENCES providers(id)
- `title` TEXT NOT NULL           -- 'Renee Matheson – Parent session', 'Tysabri infusion', etc.
- `description` TEXT
- `location` TEXT
- `start_datetime` TEXT NOT NULL
- `end_datetime` TEXT             -- optional
- `notes` TEXT
- `created_at` TEXT NOT NULL
- `updated_at` TEXT NOT NULL


### 2.9 `trips`


High-level travel legs (e.g. Bendigo → Dubbo, Dubbo → Bendigo truck return).


Fields:


- `id` INTEGER PRIMARY KEY AUTOINCREMENT
- `user_id` INTEGER NOT NULL REFERENCES users(id)
- `date` TEXT NOT NULL            -- date of travel leg
- `origin` TEXT NOT NULL
- `destination` TEXT NOT NULL
- `notes` TEXT
- `created_at` TEXT NOT NULL
- `updated_at` TEXT NOT NULL


### 2.10 `trip_assignments`


“People/vehicle matrix” rows per trip.


Fields:


- `id` INTEGER PRIMARY KEY AUTOINCREMENT
- `trip_id` INTEGER NOT NULL REFERENCES trips(id)
- `vehicle` TEXT NOT NULL         -- 'Rental truck', 'RAV4', etc.
- `driver_name` TEXT NOT NULL
- `passengers` TEXT               -- comma-separated names is fine
- `cargo_notes` TEXT              -- e.g. 'Chooks, kids gear'
- `misc_notes` TEXT
- `created_at` TEXT NOT NULL
- `updated_at` TEXT NOT NULL


### 2.11 `tasks`


Central task/checklist table.


Fields:


- `id` INTEGER PRIMARY KEY AUTOINCREMENT
- `user_id` INTEGER NOT NULL REFERENCES users(id)
- `domain_id` INTEGER NOT NULL REFERENCES domains(id)
- `title` TEXT NOT NULL            -- short label: 'Book removalist'
- `description` TEXT               -- more detail
- `status` TEXT NOT NULL           -- 'pending', 'in_progress', 'done', 'blocked'
- `priority` INTEGER NOT NULL      -- 1=low, 2=normal, 3=high (or similar)
- `due_date` TEXT                  -- nullable
- `origin_doc_id` INTEGER REFERENCES documents(id)
- `related_property_id` INTEGER REFERENCES properties(id)
- `related_job_id` INTEGER REFERENCES job_options(id)
- `related_provider_id` INTEGER REFERENCES providers(id)
- `related_childcare_id` INTEGER REFERENCES childcare_options(id)
- `related_trip_id` INTEGER REFERENCES trips(id)
- `notes` TEXT
- `created_at` TEXT NOT NULL
- `updated_at` TEXT NOT NULL


Make sure foreign key constraints are enabled (PRAGMA foreign_keys = ON).


---


## 3. Migration/init system


In `server/`, add a simple migration/init mechanism so the schema is created automatically.


### 3.1 Files & structure


Create or update:


- `server/src/db/index.ts` – DB connection and init entrypoint.
- `server/src/db/schema.ts` – SQL `CREATE TABLE` statements + seed inserts.
- `server/src/db/migrate.ts` – function to run schema + seed logic.


**`server/src/db/index.ts`**


- Export:
  - `getDb()` – returns a singleton SQLite DB connection object.
  - `initDb()` – runs migrations on startup (calling functions from `schema.ts` / `migrate.ts`).


**`server/src/db/schema.ts`**


- Define a function `createTables(db)` that:
  - Executes `CREATE TABLE IF NOT EXISTS ...` statements for every table above, in a safe order (users → domains → others).
- Define a function `seedBaseData(db)` that:
  - Inserts default user `id=1` if no users exist.
  - Inserts domain records if the `domains` table is empty.
  - Optionally inserts a Bendigo property row for `53 Buckland St` with type `bendigo_home`.


**`server/src/db/migrate.ts`**


- Export a function `runMigrations()` that:
  - Calls `getDb()`.
  - Wraps `createTables` and `seedBaseData` in a transaction if possible.
  - Logs success or throws on error.


### 3.2 Server startup integration


In `server/src/index.ts` (or wherever the Express app is started):


- Import `initDb` or `runMigrations` from `db/index` or `db/migrate`.
- Before starting the HTTP server, call `initDb()` (or `runMigrations()`).
- If migration fails, log the error and **do not** start the server.


Example (pseudocode, you generate real TS):


```ts
import { getDb } from './db';
import { runMigrations } from './db/migrate';


// ...


async function start() {
  const db = getDb();
  await runMigrations();
  app.listen(PORT, () => {
    console.log(`Server listening on http://localhost:${PORT}`);
  });
}


start().catch((err) => {
  console.error('Failed to start server', err);
  process.exit(1);
});


________________


4. TypeScript entity types
Create a shared type file in the server:
* server/src/types/entities.ts

Define interfaces matching the schema (used by the data access layer and later by route handlers). Example (you fill in all):
export interface User {
  id: number;
  name: string;
  email: string | null;
  created_at: string;
  updated_at: string;
}


export interface Domain {
  id: number;
  name: string;
  slug: string;
  created_at: string;
  updated_at: string;
}


// Task, Property, JobOption, ChildcareOption, Provider, Appointment, Trip, TripAssignment, Document...


Use these types in the query helper functions (below).
________________


5. Basic data access helpers
Create server/src/db/queries.ts with small, reusable helpers. Use the DB connection from getDb() and the types from entities.ts.
Implement at least:
// Domains
export async function getAllDomains(): Promise<Domain[]>;


// Tasks
export interface NewTaskInput {
  user_id: number;
  domain_id: number;
  title: string;
  description?: string;
  priority?: number;      // default 2
  due_date?: string | null;
  origin_doc_id?: number | null;
  related_property_id?: number | null;
  related_job_id?: number | null;
  related_provider_id?: number | null;
  related_childcare_id?: number | null;
  related_trip_id?: number | null;
  notes?: string;
}


export async function createTask(input: NewTaskInput): Promise<Task>;
export async function getTaskById(id: number): Promise<Task | null>;
export async function getTasksByDomain(domainSlugOrId: string | number): Promise<Task[]>;
export async function updateTaskStatus(id: number, status: Task['status']): Promise<Task>;
export async function deleteTask(id: number): Promise<void>;


Implementation notes:
   * When domainSlugOrId is a string, treat it as domains.slug and join accordingly.

   * Ensure default values:

      * status default 'pending'

      * priority default 2

      * created_at / updated_at default to current ISO timestamp.

         * Handle “not found” gracefully (e.g. return null from getTaskById).

For this CT2, you do not need to implement REST endpoints beyond what exists. These helpers will be used by future CT prompts to implement /api/tasks, /api/domains, etc.
________________


6. Scripts
Update server/package.json to add:
            * "db:migrate": "ts-node src/db/migrate.ts" (or equivalent based on how CT1 is set up).

Update the root README.md to mention:
               * npm run dev – still starts server + client.

               * npm run dev:server – still runs server only.

               * npm run db:migrate – optional explicit migrations run (though they also run on startup).

________________


7. Acceptance criteria
CT2 is complete when:
                  1. On server startup, the SQLite DB file is created (if not already) and all tables above exist.

                  2. The migration/init logic runs idempotently:

                     * Starting the server multiple times does NOT recreate or duplicate seed data.

                        3. A single user record and the full set of domains rows exist after first run.

                        4. There are no TypeScript compile errors in the server code.

                        5. The existing /api/health endpoint still works exactly as before.

                        6. The helper functions in db/queries.ts can be imported and used without runtime errors (e.g. you can briefly test them in a small test script or log from server startup).

Please generate all necessary code files in full, with correct imports/exports, so that I can:
                           * Create/update the files in server/src/db and server/src/types.

                           * Run npm install if new dependencies were added.

                           * Run npm run dev and see the app start successfully, with the DB schema created behind the scenes.



:contentReference[oaicite:0]{index=0}




________________

Nice, let’s level it up. Here’s CT3 ready to paste into Cursor / VS Code 👇
CT3 – Domains & Tasks REST API (Backend Only)


You are an expert TypeScript + Node.js engineer.


The existing project `pdm-parris-dubbo-mover` already has:


- `server/` – Node + Express + TypeScript backend with SQLite (via better-sqlite3 or sqlite3).
- `server/src/db` – DB connection + migrations from CT2 (including `users`, `domains`, `tasks`, etc.).
- `server/src/types/entities.ts` – TypeScript interfaces for DB entities.
- `server/src/db/queries.ts` – Basic helpers including `getAllDomains`, `createTask`, etc.
- `client/` – React + TS + Vite frontend (no tasks UI yet).
- A working `GET /api/health` endpoint.


In **CT3**, do **not** break any of the existing endpoints or schema.


Your job:  
Implement a clean **REST API** for **Domains** and **Tasks** in the backend, to support the PDM modules described in the design blueprint (domains like “housing”, “health_ms”, “packing_logistics”, etc.) and the central task/checklist system. :contentReference[oaicite:0]{index=0}  


No frontend changes yet – just backend routes, wired to the existing DB + query helpers.


---


## 1. Backend file & folder structure


Work only in `server/` for this task.


Create/ensure this structure:


- `server/src/app.ts`          – main Express app (already exists from CT1).
- `server/src/index.ts`        – server startup (already exists).
- `server/src/routes/`
  - `health.ts`                – existing health route
  - `domains.ts`               – NEW
  - `tasks.ts`                 – NEW
- `server/src/db/`
  - `index.ts` / `migrate.ts` / `schema.ts` (from CT2)
  - `queries.ts`               – already exists, will be extended if needed
- `server/src/types/entities.ts` – already exists, may be extended


Wire the new routers into `app.ts`.


---


## 2. Domain & Task TypeScript models (server types)


In `server/src/types/entities.ts`, ensure the following interfaces are defined (extend or adjust existing ones as needed to match CT2 schema):


```ts
export interface Domain {
  id: number;
  name: string;
  slug: string;
  created_at: string;
  updated_at: string;
}


export type TaskStatus = 'pending' | 'in_progress' | 'done' | 'blocked';


export interface Task {
  id: number;
  user_id: number;
  domain_id: number;
  title: string;
  description: string | null;
  status: TaskStatus;
  priority: number; // 1=low, 2=normal, 3=high
  due_date: string | null;
  origin_doc_id: number | null;
  related_property_id: number | null;
  related_job_id: number | null;
  related_provider_id: number | null;
  related_childcare_id: number | null;
  related_trip_id: number | null;
  notes: string | null;
  created_at: string;
  updated_at: string;
}


If any field names differ from CT2, align them with the actual DB schema defined there (keep consistency between schema, queries, and types).
Also declare a server-side DTO for task creation/update (in a new file or in queries.ts):
export interface NewTaskInput {
  user_id: number;
  domain_id: number;
  title: string;
  description?: string;
  priority?: number;
  due_date?: string | null;
  origin_doc_id?: number | null;
  related_property_id?: number | null;
  related_job_id?: number | null;
  related_provider_id?: number | null;
  related_childcare_id?: number | null;
  related_trip_id?: number | null;
  notes?: string;
}


export interface UpdateTaskInput {
  title?: string;
  description?: string | null;
  status?: TaskStatus;
  priority?: number;
  due_date?: string | null;
  origin_doc_id?: number | null;
  related_property_id?: number | null;
  related_job_id?: number | null;
  related_provider_id?: number | null;
  related_childcare_id?: number | null;
  related_trip_id?: number | null;
  notes?: string | null;
}


________________


3. Data access helpers (extend db/queries.ts)
If not already implemented in CT2, implement/complete these helper functions using the SQLite DB connection from getDb():
import type { Domain, Task, TaskStatus } from '../types/entities';
import type { NewTaskInput, UpdateTaskInput } from '../types/entities-or-dtos';


// Domains
export async function getAllDomains(): Promise<Domain[]>;


// Tasks
export async function createTask(input: NewTaskInput): Promise<Task>;


export async function getTaskById(id: number): Promise<Task | null>;


export async function getTasks(params: {
  domainId?: number;
  domainSlug?: string;
  status?: TaskStatus;
  dueBefore?: string; // ISO date
  limit?: number;
}): Promise<Task[]>;


export async function updateTask(id: number, input: UpdateTaskInput): Promise<Task | null>;


export async function deleteTask(id: number): Promise<void>;


Implementation details:
                              * For getTasks:

                                 * Build a SQL SELECT with optional filters:

                                    * If domainId is provided, filter by tasks.domain_id = ?.

                                    * If domainSlug is provided, join to domains on domains.id = tasks.domain_id and filter by domains.slug = ?.

                                    * If status is provided, filter by tasks.status = ?.

                                    * If dueBefore is provided, filter tasks.due_date IS NOT NULL AND tasks.due_date <= ?.

                                    * If limit is provided, LIMIT ? (default 100).

                                       * Order by due_date ascending, then priority descending, then created_at ascending.

                                          * For createTask:

                                             * Set defaults:

                                                * status = 'pending'

                                                * priority = 2 if not provided

                                                * created_at/updated_at = current ISO string.

                                                   * Insert and return the full created row.

                                                      * For updateTask:

                                                         * Only update the fields present in input.

                                                         * Always update updated_at.

                                                         * Return null if the task doesn’t exist.

                                                            * Enable foreign keys (PRAGMA foreign_keys = ON) in the DB connection (if not already done).

Use synchronous DB calls if you’re using better-sqlite3, but still wrap them in async functions so the rest of the app can use await.
________________


4. Express routes – Domains (routes/domains.ts)
Create server/src/routes/domains.ts:
                                                               * Import Router from express and getAllDomains from db/queries.

                                                               * Define:

import { Router } from 'express';
import { getAllDomains } from '../db/queries';


const router = Router();


// GET /api/domains
router.get('/', async (req, res, next) => {
  try {
    const domains = await getAllDomains();
    res.json(domains);
  } catch (err) {
    next(err);
  }
});


export default router;


In server/src/app.ts, mount this router under /api/domains:
import domainsRouter from './routes/domains';
// ...
app.use('/api/domains', domainsRouter);


________________


5. Express routes – Tasks (routes/tasks.ts)
Create server/src/routes/tasks.ts:
5.1 Validation helper
Inside tasks.ts, write a small helper to validate incoming data:
function isValidStatus(status: any): status is TaskStatus {
  return ['pending', 'in_progress', 'done', 'blocked'].includes(status);
}


function parseIntOrUndefined(value: any): number | undefined {
  if (value === undefined) return undefined;
  const n = Number(value);
  return Number.isNaN(n) ? undefined : n;
}


5.2 Routes to implement
Mount these paths under /api/tasks in app.ts.
GET /api/tasks
                                                                  * Supports query parameters:

                                                                     * domainId (number)

                                                                     * domainSlug (string)

                                                                     * status (TaskStatus)

                                                                     * dueBefore (ISO date string)

                                                                     * limit (number)

                                                                        * Use getTasks({ ... }) to fetch.

                                                                        * Return JSON array of tasks.

Example handler:
router.get('/', async (req, res, next) => {
  try {
    const domainId = parseIntOrUndefined(req.query.domainId);
    const domainSlug = typeof req.query.domainSlug === 'string' ? req.query.domainSlug : undefined;
    const status = typeof req.query.status === 'string' && isValidStatus(req.query.status)
      ? req.query.status
      : undefined;
    const dueBefore = typeof req.query.dueBefore === 'string' ? req.query.dueBefore : undefined;
    const limit = parseIntOrUndefined(req.query.limit);


    const tasks = await getTasks({ domainId, domainSlug, status, dueBefore, limit });
    res.json(tasks);
  } catch (err) {
    next(err);
  }
});


GET /api/tasks/:id
                                                                           * Parse id from path.

                                                                           * Use getTaskById(id).

                                                                           * If not found, return 404 with { error: 'Task not found' }.

POST /api/tasks
                                                                              * Expect JSON body with at least:

                                                                                 * domain_id (number) OR a domain_slug (string, e.g. "housing").

                                                                                 * title (string, non-empty).

                                                                                    * Optional:

                                                                                       * description, priority, due_date, origin_doc_id, related_* fields, notes.

                                                                                          * Assume user_id = 1 for now (single-user; later auth can override).

                                                                                          * If domain_slug is provided instead of domain_id:

                                                                                             * Look up the domains table to find the ID; if not found, return 400.

                                                                                                * Validate:

                                                                                                   * title is non-empty string.

                                                                                                   * priority if provided is 1, 2, or 3.

                                                                                                   * due_date if provided is a string; do not over-validate the format, but if it’s obviously invalid (empty string), reject.

                                                                                                      * Call createTask and return 201 with the created task.

PATCH /api/tasks/:id
Allow partial updates. Body may include any subset of:

{
  title?: string;
  description?: string | null;
  status?: TaskStatus;
  priority?: number;
  due_date?: string | null;
  origin_doc_id?: number | null;
  related_property_id?: number | null;
  related_job_id?: number | null;
  related_provider_id?: number | null;
  related_childcare_id?: number | null;
  related_trip_id?: number | null;
  notes?: string | null;
}
                                                                                                         *                                                                                                          * Validate status (using isValidStatus) and priority (1–3).

                                                                                                         * Call updateTask(id, updateInput).

                                                                                                         * If result is null, return 404. Otherwise return the updated task.

DELETE /api/tasks/:id
                                                                                                            * Call deleteTask(id).

                                                                                                            * If the task didn’t exist, you may treat it as idempotent and still return 204, or check and return 404. Either is acceptable; pick one and implement consistently.

                                                                                                            * On success, return 204 No Content.

5.3 Mounting in app.ts
In server/src/app.ts:
import tasksRouter from './routes/tasks';


// after `app.use(express.json())`, etc.
app.use('/api/tasks', tasksRouter);


Ensure error-handling middleware is present at the bottom of app.ts to catch thrown errors and return a JSON response (e.g. 500).
________________


6. README – API documentation
In the root README.md, add a short “API Overview” section describing the new endpoints:
                                                                                                               * GET /api/domains – list of domains.

                                                                                                               * GET /api/tasks – list tasks; mention query params domainId, domainSlug, status, dueBefore, limit.

                                                                                                               * GET /api/tasks/:id

                                                                                                               * POST /api/tasks

                                                                                                               * PATCH /api/tasks/:id

                                                                                                               * DELETE /api/tasks/:id

Include a quick example of creating a task via curl:
curl -X POST http://localhost:4000/api/tasks \
  -H "Content-Type: application/json" \
  -d '{
    "domain_slug": "housing",
    "title": "Book rental appraisal with Yolena",
    "priority": 3,
    "due_date": "2025-11-30T00:00:00"
  }'


(or the correct port if you expose APIs through the Vite proxy).
________________


7. Acceptance criteria
CT3 is complete when:
                                                                                                                  1. The server still starts successfully via the existing root npm run dev command.

                                                                                                                  2. GET /api/domains returns the seeded domains from CT2 (e.g. housing, childcare_schooling, health_ms, etc.).

                                                                                                                  3. POST /api/tasks with a minimal valid body (domain + title) returns 201 and the created task.

                                                                                                                  4. GET /api/tasks returns a list including the created task; filtering by domainSlug and status works as expected.

                                                                                                                  5. PATCH /api/tasks/:id can update the task’s status to 'done' and returns the updated task.

                                                                                                                  6. DELETE /api/tasks/:id removes the task and subsequent GET /api/tasks/:id returns 404.

                                                                                                                  7. All new server code type-checks (no TypeScript errors) and passes a quick manual test via curl/Postman or browser (using the dev proxy at http://localhost:3000/api/... if configured).

Please output all new/changed files in full (or clearly indicate full contents vs modifications), so I can copy/paste into the server folder and immediately use the new API.
________________


Here’s CT4 ready to paste into Cursor / VS Code 👇
CT4 – Frontend Domains & Tasks UI (React Client)


You are an expert React + TypeScript engineer.


The existing project `pdm-parris-dubbo-mover` already has:


- `client/` – React + TypeScript + Vite app.
- `server/` – Node + Express + TypeScript backend with:
  - SQLite schema (users, domains, tasks, etc.) from CT2.
  - REST API from CT3:
    - `GET /api/domains`
    - `GET /api/tasks` (+ filters)
    - `GET /api/tasks/:id`
    - `POST /api/tasks`
    - `PATCH /api/tasks/:id`
    - `DELETE /api/tasks/:id`
- Vite dev server proxy so `client` can hit `/api/...` without CORS problems.
- A home page that currently just shows “PDM App running” and calls `/api/health`.


Do **not** break any existing behaviour.  
Your job in CT4: implement a **basic but solid Domains + Tasks UI** so the user can:


- See all domains (e.g. “Housing & Rentals”, “Childcare & Schooling”, “Health & MS”, etc.).
- Select a domain.
- View tasks for that domain.
- Create, update, and delete tasks via the existing API.


We’re aiming for a clean foundation, not perfect styling yet.


---


## 1. Client-side API layer


In `client/src/`, create a small, typed API helper layer for domains and tasks.


### 1.1 Types


Create a file `client/src/types/api.ts` with:


```ts
export interface Domain {
  id: number;
  name: string;
  slug: string;
  created_at: string;
  updated_at: string;
}


export type TaskStatus = 'pending' | 'in_progress' | 'done' | 'blocked';


export interface Task {
  id: number;
  user_id: number;
  domain_id: number;
  title: string;
  description: string | null;
  status: TaskStatus;
  priority: number; // 1=low, 2=normal, 3=high
  due_date: string | null;
  origin_doc_id: number | null;
  related_property_id: number | null;
  related_job_id: number | null;
  related_provider_id: number | null;
  related_childcare_id: number | null;
  related_trip_id: number | null;
  notes: string | null;
  created_at: string;
  updated_at: string;
}


export interface NewTaskPayload {
  domain_id?: number;
  domain_slug?: string;
  title: string;
  description?: string;
  priority?: number;
  due_date?: string | null;
  origin_doc_id?: number | null;
  related_property_id?: number | null;
  related_job_id?: number | null;
  related_provider_id?: number | null;
  related_childcare_id?: number | null;
  related_trip_id?: number | null;
  notes?: string;
}


export interface UpdateTaskPayload {
  title?: string;
  description?: string | null;
  status?: TaskStatus;
  priority?: number;
  due_date?: string | null;
  origin_doc_id?: number | null;
  related_property_id?: number | null;
  related_job_id?: number | null;
  related_provider_id?: number | null;
  related_childcare_id?: number | null;
  related_trip_id?: number | null;
  notes?: string | null;
}


Match field names exactly to what the backend returns (from CT3).
1.2 API helpers
Create client/src/api/client.ts:
                                                                                                                     * Implement a thin wrapper around fetch that:

                                                                                                                        * Uses window.fetch.

                                                                                                                        * Automatically JSON-encodes bodies for non-GET requests.

                                                                                                                        * Throws on non-2xx responses with useful error info.

Example structure (you generate full code):
const API_BASE = ''; // empty, rely on Vite proxy so `/api/...` works


async function apiRequest<T>(path: string, options: RequestInit = {}): Promise<T> {
  const res = await fetch(API_BASE + path, {
    headers: {
      'Content-Type': 'application/json',
      ...(options.headers || {}),
    },
    ...options,
  });


  if (!res.ok) {
    let message = `Request failed with status ${res.status}`;
    try {
      const data = await res.json();
      if (data && typeof data.error === 'string') {
        message = data.error;
      }
    } catch {
      // ignore
    }
    throw new Error(message);
  }


  if (res.status === 204) {
    return undefined as unknown as T;
  }


  return res.json() as Promise<T>;
}


export { apiRequest };


Create client/src/api/domains.ts and client/src/api/tasks.ts:
// domains.ts
import { apiRequest } from './client';
import type { Domain } from '../types/api';


export async function fetchDomains(): Promise<Domain[]> {
  return apiRequest<Domain[]>('/api/domains');
}


// tasks.ts
import { apiRequest } from './client';
import type { Task, NewTaskPayload, UpdateTaskPayload, TaskStatus } from '../types/api';


export interface TaskQueryParams {
  domainId?: number;
  domainSlug?: string;
  status?: TaskStatus;
  dueBefore?: string;
  limit?: number;
}


export async function fetchTasks(params: TaskQueryParams = {}): Promise<Task[]> {
  const searchParams = new URLSearchParams();
  if (params.domainId != null) searchParams.set('domainId', String(params.domainId));
  if (params.domainSlug) searchParams.set('domainSlug', params.domainSlug);
  if (params.status) searchParams.set('status', params.status);
  if (params.dueBefore) searchParams.set('dueBefore', params.dueBefore);
  if (params.limit != null) searchParams.set('limit', String(params.limit));


  const query = searchParams.toString();
  const path = query ? `/api/tasks?${query}` : '/api/tasks';
  return apiRequest<Task[]>(path);
}


export async function createTask(payload: NewTaskPayload): Promise<Task> {
  return apiRequest<Task>('/api/tasks', {
    method: 'POST',
    body: JSON.stringify(payload),
  });
}


export async function updateTask(id: number, payload: UpdateTaskPayload): Promise<Task> {
  return apiRequest<Task>(`/api/tasks/${id}`, {
    method: 'PATCH',
    body: JSON.stringify(payload),
  });
}


export async function deleteTask(id: number): Promise<void> {
  return apiRequest<void>(`/api/tasks/${id}`, {
    method: 'DELETE',
  });
}


________________


2. Layout & Navigation
Update the main app layout so it feels like a small “mission control” for tasks.
2.1 App shell
In client/src/App.tsx:
                                                                                                                           * Use react-router-dom’s <BrowserRouter> around the app.

                                                                                                                           * Create routes:

                                                                                                                              * / – “Dashboard” (for now just show a welcome and maybe a summary of domain counts later).

                                                                                                                              * /tasks – Domains + Tasks screen (main focus of CT4).

                                                                                                                                 * Add a very simple navigation header (no heavy styling needed):

                                                                                                                                    * App title: “ParrisDubboMover (PDM)”.

                                                                                                                                    * Links: “Dashboard”, “Tasks”.

Example (you write real TSX):
return (
  <BrowserRouter>
    <div className="app-shell">
      <header>...</header>
      <main>
        <Routes>
          <Route path="/" element={<DashboardPage />} />
          <Route path="/tasks" element={<TasksPage />} />
        </Routes>
      </main>
    </div>
  </BrowserRouter>
);


Create client/src/pages/DashboardPage.tsx and client/src/pages/TasksPage.tsx.
                                                                                                                                       * DashboardPage can be very simple for now (e.g. “PDM App running – Dashboard”).

                                                                                                                                       * TasksPage will host the new UI.

________________


3. Tasks Page UI
The Tasks page should have:
                                                                                                                                          * Left pane: list of domains.

                                                                                                                                          * Right pane: tasks for the selected domain, with basic CRUD.

3.1 Domain list (left pane)
Create a component client/src/components/DomainList.tsx:
Props:
interface DomainListProps {
  domains: Domain[];
  selectedDomainId: number | null;
  onSelectDomain: (domain: Domain) => void;
}


Behaviour:
                                                                                                                                             * Render a vertical list of buttons or clickable items for each domain.

                                                                                                                                             * Highlight the currently selected domain.

                                                                                                                                             * When a domain is clicked, call onSelectDomain(domain).

Styling can be simple:
                                                                                                                                                * Left column ~250px wide.

                                                                                                                                                * Right column fills the rest.

3.2 Task list & controls (right pane)
Create client/src/components/TaskList.tsx:
Props:
interface TaskListProps {
  tasks: Task[];
  onEditTask: (task: Task) => void;
  onDeleteTask: (task: Task) => void;
  onToggleStatus: (task: Task) => void; // e.g. pending <-> done
}


Behaviour:
                                                                                                                                                   * Display tasks in a table or list; show:

                                                                                                                                                      * Title

                                                                                                                                                      * Status (with a small badge or text)

                                                                                                                                                      * Priority (1/2/3 → maybe Low/Normal/High)

                                                                                                                                                      * Due date (formatted, or “–”)

                                                                                                                                                         * For each task, show action buttons:

                                                                                                                                                            * “Edit”

                                                                                                                                                            * “Delete”

                                                                                                                                                            * “Toggle Done” (e.g. if status is done, set it back to pending, otherwise set to done).

3.3 Task create/edit form
Create client/src/components/TaskFormModal.tsx (or TaskForm.tsx with a simple overlay):
Props:
interface TaskFormModalProps {
  open: boolean;
  mode: 'create' | 'edit';
  initialTask?: Task;
  domain: Domain | null;
  onCancel: () => void;
  onSubmit: (data: { title: string; description: string; priority: number; due_date: string | null; }) => void;
}


Behaviour:
                                                                                                                                                               * If open is false, render null.

                                                                                                                                                               * If open is true:

                                                                                                                                                                  * Show a simple overlay / modal (can be pure CSS with a fixed position).

                                                                                                                                                                  * Fields:

                                                                                                                                                                     * Title (required)

                                                                                                                                                                     * Description (textarea)

                                                                                                                                                                     * Priority (select with 1/2/3 and labels)

                                                                                                                                                                     * Due date (input type="date"; convert to ISO date string on submit like YYYY-MM-DDT00:00:00 or just YYYY-MM-DD consistently).

                                                                                                                                                                        * When in edit mode:

                                                                                                                                                                           * Pre-fill fields from initialTask.

                                                                                                                                                                              * On submit:

                                                                                                                                                                                 * Validate that title is non-empty.

                                                                                                                                                                                 * Call onSubmit(...).

No need for fancy libraries – just use React state and basic HTML inputs.
________________


4. Wiring it together in TasksPage
In client/src/pages/TasksPage.tsx:
State:
                                                                                                                                                                                    * domains: Domain[]

                                                                                                                                                                                    * selectedDomain: Domain | null

                                                                                                                                                                                    * tasks: Task[]

                                                                                                                                                                                    * loadingDomains: boolean

                                                                                                                                                                                    * loadingTasks: boolean

                                                                                                                                                                                    * error: string | null

                                                                                                                                                                                    * isFormOpen: boolean

                                                                                                                                                                                    * formMode: 'create' | 'edit'

                                                                                                                                                                                    * editingTask: Task | null

Effects:
                                                                                                                                                                                       1. On mount:

                                                                                                                                                                                          * Fetch domains via fetchDomains().

                                                                                                                                                                                          * Set the first domain as selectedDomain by default (if any).

                                                                                                                                                                                             2. Whenever selectedDomain changes:

                                                                                                                                                                                                * Fetch tasks for that domain via fetchTasks({ domainId: selectedDomain.id }).

Handlers:
                                                                                                                                                                                                   * handleSelectDomain(domain: Domain):

                                                                                                                                                                                                      * Set selectedDomain.

                                                                                                                                                                                                      * Clear existing tasks or set to loading; trigger fetch.

                                                                                                                                                                                                         * handleOpenCreateTask():

                                                                                                                                                                                                            * Only if selectedDomain is not null.

                                                                                                                                                                                                            * Set formMode = 'create', editingTask = null, isFormOpen = true.

                                                                                                                                                                                                               * handleOpenEditTask(task: Task):

                                                                                                                                                                                                                  * Set formMode = 'edit', editingTask = task, isFormOpen = true.

                                                                                                                                                                                                                     * handleSubmitTask(formData):

                                                                                                                                                                                                                        * If formMode === 'create' and selectedDomain is set:

                                                                                                                                                                                                                           * Call createTask({ domain_id: selectedDomain.id, ...mappedFormData }).

                                                                                                                                                                                                                           * On success, close modal and refresh tasks for this domain.

                                                                                                                                                                                                                              * If formMode === 'edit' and editingTask exists:

                                                                                                                                                                                                                                 * Call updateTask(editingTask.id, mappedFormData).

                                                                                                                                                                                                                                 * On success, close modal and refresh tasks.

                                                                                                                                                                                                                                    * Handle errors by setting error and displaying a simple message.

                                                                                                                                                                                                                                       * handleToggleStatus(task: Task):

                                                                                                                                                                                                                                          * Compute new status:

                                                                                                                                                                                                                                             * If task.status === 'done', set to 'pending'.

                                                                                                                                                                                                                                             * Else set to 'done'.

                                                                                                                                                                                                                                                * Call updateTask(task.id, { status: newStatus }).

                                                                                                                                                                                                                                                * On success, update the tasks list in state (or re-fetch).

                                                                                                                                                                                                                                                   * handleDeleteTask(task: Task):

                                                                                                                                                                                                                                                      * Confirm with window.confirm.

                                                                                                                                                                                                                                                      * Call deleteTask(task.id).

                                                                                                                                                                                                                                                      * On success, remove from state or re-fetch.

UI structure:
Show a 2-column layout:

<div className="tasks-page">
  <div className="tasks-layout">
    <aside className="tasks-domains-column">
      {/* DomainList */}
    </aside>
    <section className="tasks-main-column">
      {/* Selected domain title */}
      {/* New Task button */}
      {/* TaskList */}
    </section>
  </div>
</div>
                                                                                                                                                                                                                                                         *                                                                                                                                                                                                                                                          * If there are no domains:

                                                                                                                                                                                                                                                            * Show a message like “No domains available – check backend seed data.”

                                                                                                                                                                                                                                                               * Show loading indicators and simple error messages where appropriate.

________________


5. Basic styling
In client/src/index.css (or similar global stylesheet):
                                                                                                                                                                                                                                                                  * Implement minimal layout styles:

                                                                                                                                                                                                                                                                     * App shell with header and main.

                                                                                                                                                                                                                                                                     * Tasks page with two columns using CSS grid or flexbox.

                                                                                                                                                                                                                                                                        * Keep it simple and readable:

                                                                                                                                                                                                                                                                           * Left sidebar: narrow, light background.

                                                                                                                                                                                                                                                                           * Right content: main area.

                                                                                                                                                                                                                                                                              * No need for Tailwind, MUI, etc. unless they already exist – plain CSS is fine.

________________


6. README update
In the root README.md, add a short section:
                                                                                                                                                                                                                                                                                 * “Tasks UI”:

                                                                                                                                                                                                                                                                                    * Explain that visiting /tasks in the browser:

                                                                                                                                                                                                                                                                                       * Shows domain list on the left.

                                                                                                                                                                                                                                                                                       * Allows selecting a domain and managing tasks for that domain.

________________


________________
7. Acceptance criteria
CT4 is complete when:
                                                                                                                                                                                                                                                                                          1. npm run dev from the repo root still starts both backend and frontend successfully.

                                                                                                                                                                                                                                                                                          2. Visiting http://localhost:3000/tasks shows:

                                                                                                                                                                                                                                                                                             * A list of domains on the left (from GET /api/domains).

                                                                                                                                                                                                                                                                                             * When a domain is selected, a list of tasks for that domain (from GET /api/tasks?domainId=...).

                                                                                                                                                                                                                                                                                                3. The user can:

                                                                                                                                                                                                                                                                                                   * Create a new task for the selected domain via a form.

                                                                                                                                                                                                                                                                                                   * Edit an existing task’s title/description/priority/due date.

                                                                                                                                                                                                                                                                                                   * Toggle task status between pending and done.

                                                                                                                                                                                                                                                                                                   * Delete a task.

                                                                                                                                                                                                                                                                                                      4. All operations use the existing REST API from CT3, and changes persist in SQLite.

                                                                                                                                                                                                                                                                                                      5. There are no TypeScript errors in the client, and the UI behaves reasonably on a laptop and a phone-width viewport (simple responsive layout is enough).

Please output all new/changed files (TSX, TS, CSS) in full, with correct imports and exports, so I can copy them into client/src and have a working Domains + Tasks UI.
________________


CT5 – Document Upload, Storage & Basic Document Browser (Backend + Frontend)


You are an expert full-stack TypeScript engineer.


The existing project `pdm-parris-dubbo-mover` already has:


- `server/` – Node + Express + TypeScript backend with:
  - SQLite schema including a `documents` table (from CT2).
  - DB helpers and a tasks/domains REST API (from CT3).
- `client/` – React + TypeScript + Vite frontend with:
  - Basic app shell and navigation.
  - Tasks UI (domains + tasks) from CT4.
- Vite dev server proxy so `/api/...` is proxied to the backend.


Do **not** break any existing behaviour.


Your job in CT5: implement **document upload + basic document browser**, so the user can:


- Upload PDFs/DOCX/TXT (and optionally images for now, stored but with no OCR).
- Store them in the `documents` table and on disk.
- View a list of uploaded documents.
- Click a document to see metadata and a preview of extracted text.


This will later be used to generate tasks and “what next” suggestions.


---


## 1. Backend – File upload & document APIs


Work in `server/`.


### 1.1 Dependencies


Add to `server/package.json`:


- For parsing multipart/form-data:
  - `multer`
- For text extraction:
  - `pdf-parse` for PDFs
  - `mammoth` for DOCX
- (Optional) Fallback: treat `.txt` as plain text; `.docx` via `mammoth`; unknown binaries stored with empty `content_text` for now.


Add `@types/multer` to devDependencies.


Run `npm install` according to your normal workflow.


### 1.2 Directory for uploads


In `server/`:


- Create a folder `uploads/` at the project root of `server` (sibling of `src/`), and ensure it is used to store uploaded files.
- Update `.gitignore` (either root or server-level) to ignore `server/uploads` contents, except maybe a `.gitkeep` if needed.


### 1.3 DB helper for documents


Extend `server/src/types/entities.ts`:


```ts
export interface Document {
  id: number;
  user_id: number;
  title: string;
  original_filename: string | null;
  source_path: string | null;
  content_text: string | null;
  uploaded_at: string;
  updated_at: string;
}


Match the actual schema created in CT2.
In server/src/db/queries.ts, add:
import type { Document } from '../types/entities';


export interface NewDocumentInput {
  user_id: number;
  title: string;
  original_filename?: string | null;
  source_path?: string | null;
  content_text?: string | null;
}


export async function createDocument(input: NewDocumentInput): Promise<Document>;


export async function getDocumentById(id: number): Promise<Document | null>;


export async function listDocuments(params?: {
  limit?: number;
  search?: string; // search in title or content_text
}): Promise<Document[]>;


Implementation notes:
                                                                                                                                                                                                                                                                                                         * createDocument:

                                                                                                                                                                                                                                                                                                            * Set uploaded_at and updated_at to current ISO string.

                                                                                                                                                                                                                                                                                                            * Insert into documents and return the full row.

                                                                                                                                                                                                                                                                                                               * getDocumentById:

                                                                                                                                                                                                                                                                                                                  * SELECT * FROM documents WHERE id = ?.

                                                                                                                                                                                                                                                                                                                     * listDocuments:

                                                                                                                                                                                                                                                                                                                        * If search is provided, filter with a LIKE on title OR content_text (e.g. %search%).

                                                                                                                                                                                                                                                                                                                        * Limit results (default 100 if no limit given).

                                                                                                                                                                                                                                                                                                                        * Order by uploaded_at DESC.

1.4 Text extraction helpers
Create a new file server/src/services/documentTextExtractor.ts:
Implement functions:
import fs from 'fs';
import path from 'path';
import pdfParse from 'pdf-parse';
import mammoth from 'mammoth';


export async function extractTextFromFile(filePath: string, mimeType?: string, originalFilename?: string): Promise<string> {
  const ext = (originalFilename || '').toLowerCase();


  if (mimeType === 'application/pdf' || ext.endsWith('.pdf')) {
    return extractPdfText(filePath);
  }


  if (
    mimeType === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' ||
    ext.endsWith('.docx')
  ) {
    return extractDocxText(filePath);
  }


  if (mimeType === 'text/plain' || ext.endsWith('.txt')) {
    return extractTxtText(filePath);
  }


  // For unsupported types (e.g., images), just return empty string for now.
  return '';
}


async function extractPdfText(filePath: string): Promise<string> {
  const data = await fs.promises.readFile(filePath);
  const result = await pdfParse(data);
  return result.text || '';
}


async function extractDocxText(filePath: string): Promise<string> {
  const result = await mammoth.extractRawText({ path: filePath });
  return result.value || '';
}


async function extractTxtText(filePath: string): Promise<string> {
  const data = await fs.promises.readFile(filePath, 'utf8');
  return data.toString();
}


Handle errors gracefully in the calling code (if extraction fails, log and proceed with empty content_text).
1.5 Express routes – /api/documents
Create server/src/routes/documents.ts:
                                                                                                                                                                                                                                                                                                                           * Use multer for file upload.

                                                                                                                                                                                                                                                                                                                           * Add routes:

POST /api/documents/upload
                                                                                                                                                                                                                                                                                                                              * Accept multipart/form-data with:

                                                                                                                                                                                                                                                                                                                                 1. Field name: file (single file).

                                                                                                                                                                                                                                                                                                                                 2. Optional text fields:

                                                                                                                                                                                                                                                                                                                                    * title (string); if not provided, default to the original filename.

                                                                                                                                                                                                                                                                                                                                    * user_id (ignore for now; default to 1).

                                                                                                                                                                                                                                                                                                                                       * Validate:

                                                                                                                                                                                                                                                                                                                                          1. If no file, return 400 with { error: 'File is required' }.

                                                                                                                                                                                                                                                                                                                                             * On success:

                                                                                                                                                                                                                                                                                                                                                1. Save the file to server/uploads/<timestamp>_<originalname>.

                                                                                                                                                                                                                                                                                                                                                2. Extract text via extractTextFromFile(filePath, mimeType, originalFilename).

                                                                                                                                                                                                                                                                                                                                                3. Call createDocument with:

                                                                                                                                                                                                                                                                                                                                                   * user_id = 1

                                                                                                                                                                                                                                                                                                                                                   * title from field or filename

                                                                                                                                                                                                                                                                                                                                                   * original_filename

                                                                                                                                                                                                                                                                                                                                                   * source_path as the relative path, e.g. uploads/<timestamp>_<originalname>

                                                                                                                                                                                                                                                                                                                                                   * content_text as extraction result (string; you may truncate if extremely large, but no need yet).

                                                                                                                                                                                                                                                                                                                                                      4. Return 201 with the created document JSON.

GET /api/documents
                                                                                                                                                                                                                                                                                                                                                         * Query params:

                                                                                                                                                                                                                                                                                                                                                            * limit (number)

                                                                                                                                                                                                                                                                                                                                                            * search (string)

                                                                                                                                                                                                                                                                                                                                                               * Call listDocuments({ limit, search }).

                                                                                                                                                                                                                                                                                                                                                               * Return JSON array of documents, but omit content_text by default (to keep payload smaller).

                                                                                                                                                                                                                                                                                                                                                                  * You can either:

                                                                                                                                                                                                                                                                                                                                                                     * Exclude content_text in the SQL query, or

                                                                                                                                                                                                                                                                                                                                                                     * Include it and map it out before sending.

For simplicity, you can return the whole row including content_text, but note that the frontend will only display a trimmed preview. (Either approach is acceptable; document your choice in a comment.)
GET /api/documents/:id
                                                                                                                                                                                                                                                                                                                                                                        * Fetch document by ID with getDocumentById.

                                                                                                                                                                                                                                                                                                                                                                        * If not found, return 404 { error: 'Document not found' }.

                                                                                                                                                                                                                                                                                                                                                                        * Return the full document including content_text.

Later we may add endpoints to link documents to tasks; not needed in CT5.
1.6 Hook up routes
In server/src/app.ts:
import documentsRouter from './routes/documents';


app.use('/api/documents', documentsRouter);


Ensure any error-handling middleware is defined at the bottom of the file.
________________


2. Frontend – Document Browser & Upload UI
Work in client/.
2.1 Types & API helpers
Extend client/src/types/api.ts:
export interface Document {
  id: number;
  user_id: number;
  title: string;
  original_filename: string | null;
  source_path: string | null;
  content_text: string | null;
  uploaded_at: string;
  updated_at: string;
}


Create client/src/api/documents.ts:
import { apiRequest } from './client';
import type { Document } from '../types/api';


export interface ListDocumentsParams {
  limit?: number;
  search?: string;
}


export async function listDocuments(params: ListDocumentsParams = {}): Promise<Document[]> {
  const searchParams = new URLSearchParams();
  if (params.limit != null) searchParams.set('limit', String(params.limit));
  if (params.search) searchParams.set('search', params.search);


  const query = searchParams.toString();
  const path = query ? `/api/documents?${query}` : '/api/documents';
  return apiRequest<Document[]>(path);
}


export async function getDocument(id: number): Promise<Document> {
  return apiRequest<Document>(`/api/documents/${id}`);
}


export async function uploadDocument(file: File, title?: string): Promise<Document> {
  const formData = new FormData();
  formData.append('file', file);
  if (title) formData.append('title', title);


  const res = await fetch('/api/documents/upload', {
    method: 'POST',
    body: formData,
  });


  if (!res.ok) {
    let message = `Upload failed with status ${res.status}`;
    try {
      const data = await res.json();
      if (data && typeof data.error === 'string') {
        message = data.error;
      }
    } catch {
      // ignore
    }
    throw new Error(message);
  }


  return res.json() as Promise<Document>;
}


Note: This uploadDocument bypasses apiRequest because it uses FormData and must not set Content-Type manually.
2.2 Navigation
In client/src/App.tsx:
                                                                                                                                                                                                                                                                                                                                                                           * Add a new route /documents linked in the main nav:

                                                                                                                                                                                                                                                                                                                                                                              * Header links: “Dashboard”, “Tasks”, “Documents”.

                                                                                                                                                                                                                                                                                                                                                                                 * Import and use DocumentsPage (created below).

2.3 Documents page & components
Create client/src/pages/DocumentsPage.tsx:
State:
                                                                                                                                                                                                                                                                                                                                                                                    * documents: Document[]

                                                                                                                                                                                                                                                                                                                                                                                    * selectedDocument: Document | null

                                                                                                                                                                                                                                                                                                                                                                                    * loading: boolean

                                                                                                                                                                                                                                                                                                                                                                                    * error: string | null

                                                                                                                                                                                                                                                                                                                                                                                    * search: string

                                                                                                                                                                                                                                                                                                                                                                                    * uploading: boolean

Effects:
                                                                                                                                                                                                                                                                                                                                                                                       1. On mount (and when search changes, with a short debounce if you like, but not required), call listDocuments({ search }) and populate documents.

Handlers:
                                                                                                                                                                                                                                                                                                                                                                                          * handleSelectDocument(doc: Document) → set selectedDocument.

                                                                                                                                                                                                                                                                                                                                                                                          * handleUpload(file: File, title?: string):

                                                                                                                                                                                                                                                                                                                                                                                             * Set uploading = true.

                                                                                                                                                                                                                                                                                                                                                                                             * Call uploadDocument(file, title).

                                                                                                                                                                                                                                                                                                                                                                                             * On success:

                                                                                                                                                                                                                                                                                                                                                                                                * Push the new document into documents (or re-fetch with listDocuments).

                                                                                                                                                                                                                                                                                                                                                                                                * Set selectedDocument to the new document.

                                                                                                                                                                                                                                                                                                                                                                                                   * Handle errors by setting error.

Layout:
                                                                                                                                                                                                                                                                                                                                                                                                      * Two-column layout (similar to Tasks):

                                                                                                                                                                                                                                                                                                                                                                                                         * Left: document list + search + upload form.

                                                                                                                                                                                                                                                                                                                                                                                                         * Right: document detail/preview.

Create components:
client/src/components/DocumentUploadForm.tsx
Props:
interface DocumentUploadFormProps {
  onUpload: (file: File, title?: string) => void;
  uploading: boolean;
}


Behaviour:
                                                                                                                                                                                                                                                                                                                                                                                                            * Render:

                                                                                                                                                                                                                                                                                                                                                                                                               * A file input (input type="file").

                                                                                                                                                                                                                                                                                                                                                                                                               * Optional title input.

                                                                                                                                                                                                                                                                                                                                                                                                               * Upload button.

                                                                                                                                                                                                                                                                                                                                                                                                                  * When the user selects a file and clicks Upload:

                                                                                                                                                                                                                                                                                                                                                                                                                     * Call onUpload(file, title).

                                                                                                                                                                                                                                                                                                                                                                                                                        * Disable the button and show “Uploading…” if uploading is true.

client/src/components/DocumentList.tsx
Props:
interface DocumentListProps {
  documents: Document[];
  selectedDocumentId: number | null;
  onSelect: (doc: Document) => void;
}


Behaviour:
                                                                                                                                                                                                                                                                                                                                                                                                                           * Render a scrollable list of documents:

                                                                                                                                                                                                                                                                                                                                                                                                                              * Show title (or original_filename if title is missing).

                                                                                                                                                                                                                                                                                                                                                                                                                              * Show uploaded_at in a small, human-friendly date format.

                                                                                                                                                                                                                                                                                                                                                                                                                                 * Highlight the selected document.

                                                                                                                                                                                                                                                                                                                                                                                                                                 * On click, call onSelect(doc).

client/src/components/DocumentDetail.tsx
Props:
interface DocumentDetailProps {
  document: Document | null;
}


Behaviour:
                                                                                                                                                                                                                                                                                                                                                                                                                                    * If document is null, show a placeholder: “Select a document to view details.”

                                                                                                                                                                                                                                                                                                                                                                                                                                    * If not null:

                                                                                                                                                                                                                                                                                                                                                                                                                                       * Show:

                                                                                                                                                                                                                                                                                                                                                                                                                                          * Title

                                                                                                                                                                                                                                                                                                                                                                                                                                          * Original filename

                                                                                                                                                                                                                                                                                                                                                                                                                                          * Uploaded date

                                                                                                                                                                                                                                                                                                                                                                                                                                             * Show a text preview:

                                                                                                                                                                                                                                                                                                                                                                                                                                                * Use document.content_text || ''.

                                                                                                                                                                                                                                                                                                                                                                                                                                                * Truncate to, say, the first 1000–2000 characters.

                                                                                                                                                                                                                                                                                                                                                                                                                                                * Display in a <pre> or <div> with white-space: pre-wrap.

                                                                                                                                                                                                                                                                                                                                                                                                                                                   * (Optional) Later we’ll add “Create tasks from this doc” actions; for now, just display.

2.4 DocumentsPage layout
Example (you write actual TSX):
export function DocumentsPage() {
  // state, effects, handlers


  return (
    <div className="documents-page">
      <h1>Documents</h1>
      {error && <div className="error-banner">{error}</div>}
      <div className="documents-layout">
        <aside className="documents-sidebar">
          <div className="documents-search">
            <input
              type="text"
              placeholder="Search documents..."
              value={search}
              onChange={(e) => setSearch(e.target.value)}
            />
          </div>
          <DocumentUploadForm onUpload={handleUpload} uploading={uploading} />
          <DocumentList
            documents={documents}
            selectedDocumentId={selectedDocument ? selectedDocument.id : null}
            onSelect={handleSelectDocument}
          />
        </aside>
        <section className="documents-main">
          <DocumentDetail document={selectedDocument} />
        </section>
      </div>
    </div>
  );
}


________________


3. Basic styling
In client/src/index.css (or appropriate global stylesheet):
                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Add styles for:

                                                                                                                                                                                                                                                                                                                                                                                                                                                         * .documents-page – overall container.

                                                                                                                                                                                                                                                                                                                                                                                                                                                         * .documents-layout – two-column layout, using flexbox or CSS grid.

                                                                                                                                                                                                                                                                                                                                                                                                                                                         * .documents-sidebar – narrow column (e.g. 280px), scrollable.

                                                                                                                                                                                                                                                                                                                                                                                                                                                         * .documents-main – main content.

                                                                                                                                                                                                                                                                                                                                                                                                                                                         * .error-banner – simple red text or box.

                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Inputs and buttons – basic padding/margins.

Reuse the same visual feel as the Tasks page so the app feels consistent.
________________


4. README update
In root README.md, extend the “API Overview” and “UI” sections:
                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Add:

                                                                                                                                                                                                                                                                                                                                                                                                                                                               * POST /api/documents/upload – upload a file with multipart/form-data.

                                                                                                                                                                                                                                                                                                                                                                                                                                                               * GET /api/documents – list documents, with limit and search.

                                                                                                                                                                                                                                                                                                                                                                                                                                                               * GET /api/documents/:id – get a specific document, including content_text.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Add a note that visiting /documents in the app:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Allows uploading and browsing documents.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Shows a text preview of extracted content.

________________


5. Acceptance criteria
CT5 is complete when:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1. npm run dev from the repo root still starts backend and frontend successfully.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                        2. POST /api/documents/upload with a PDF/DOCX/TXT file:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Saves the file to server/uploads.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Creates a row in documents with populated title, original_filename, source_path, uploaded_at, updated_at, and a non-empty content_text for supported formats.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                              3. GET /api/documents returns a list of uploaded documents.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                              4. GET /api/documents/:id returns the full document including content_text.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                              5. Visiting http://localhost:3000/documents:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Shows an upload form and a list of documents on the left.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Shows document details and a text preview on the right when a document is selected.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    6. Uploading a new document via the UI:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Adds it to the list.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Selecting it shows metadata and a preview.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          7. There are no TypeScript errors in client or server, and the features behave reasonably on desktop and phone-width viewports.

Please output all new/changed files in full (TS, TSX, CSS, route files, etc.), with correct imports and exports, so I can paste them into the project and immediately get a working document upload + browser feature.
________________


Here we go – CT6 coming right up 👇
CT6 – Move Logistics: Trips, People/Vehicle Matrix & Timeline Page (Backend + Frontend)


You are an expert full-stack TypeScript engineer.


The existing `pdm-parris-dubbo-mover` project already has:


- Backend (`server/`):
  - Node + Express + TypeScript.
  - SQLite schema from CT2, including `trips` and `trip_assignments` tables.
  - DB helpers and REST APIs for `domains` and `tasks` from CT3.
  - Migrations wired into startup.
- Frontend (`client/`):
  - React + TypeScript + Vite.
  - App shell with navigation.
  - Tasks UI (domains + tasks) from CT4.
  - Documents UI from CT5.
- Vite dev server proxy so `/api/...` hits the backend.


Do **not** break existing functionality.


Your job in CT6: implement the **Move Logistics module**:


- Backend:
  - REST APIs for `trips` + `trip_assignments`.
- Frontend:
  - A “Move Plan” page showing:
    - A list/timeline of trips (move legs).
    - A “people/vehicle matrix” for each trip (who’s in which vehicle, with what cargo).
    - A small view of packing/logistics tasks (domain `packing_logistics`) for the same period.


---


## 1. Backend – Types & DB Helpers for Trips


Work in `server/`.


### 1.1 Types


In `server/src/types/entities.ts`, add/ensure these interfaces match the actual schema from CT2:


```ts
export interface Trip {
  id: number;
  user_id: number;
  date: string; // ISO date, e.g. "2026-01-14"
  origin: string;
  destination: string;
  notes: string | null;
  created_at: string;
  updated_at: string;
}


export interface TripAssignment {
  id: number;
  trip_id: number;
  vehicle: string;
  driver_name: string;
  passengers: string | null;   // e.g. "Kristy, Sylvie, Elias"
  cargo_notes: string | null;  // what's being carried
  misc_notes: string | null;
  created_at: string;
  updated_at: string;
}


Also define DTO types for creation/update – either in this file or in a new dtos.ts:
export interface NewTripInput {
  user_id: number;
  date: string;       // required
  origin: string;     // required
  destination: string;// required
  notes?: string | null;
}


export interface UpdateTripInput {
  date?: string;
  origin?: string;
  destination?: string;
  notes?: string | null;
}


export interface NewTripAssignmentInput {
  trip_id: number;
  vehicle: string;
  driver_name: string;
  passengers?: string | null;
  cargo_notes?: string | null;
  misc_notes?: string | null;
}


export interface UpdateTripAssignmentInput {
  vehicle?: string;
  driver_name?: string;
  passengers?: string | null;
  cargo_notes?: string | null;
  misc_notes?: string | null;
}


Make sure these align with actual column names & types in the DB schema.
1.2 DB helpers in db/queries.ts
Extend server/src/db/queries.ts with Trip helper functions.
Imports:
import type {
  Trip,
  TripAssignment,
  NewTripInput,
  UpdateTripInput,
  NewTripAssignmentInput,
  UpdateTripAssignmentInput,
} from '../types/entities';


Implement:
export interface ListTripsParams {
  fromDate?: string; // inclusive
  toDate?: string;   // inclusive
  limit?: number;
}


export async function listTrips(params: ListTripsParams = {}): Promise<Trip[]>;


export async function getTripById(id: number): Promise<Trip | null>;


export async function createTrip(input: NewTripInput): Promise<Trip>;


export async function updateTrip(id: number, input: UpdateTripInput): Promise<Trip | null>;


export async function deleteTrip(id: number): Promise<void>;


// Assignments
export async function listTripAssignmentsByTripId(tripId: number): Promise<TripAssignment[]>;


export async function createTripAssignment(input: NewTripAssignmentInput): Promise<TripAssignment>;


export async function updateTripAssignment(
  id: number,
  input: UpdateTripAssignmentInput
): Promise<TripAssignment | null>;


export async function deleteTripAssignment(id: number): Promise<void>;


Implementation notes:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * All functions should use getDb() and respect foreign keys.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * listTrips:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Build a SELECT * FROM trips WHERE 1=1 query.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * If fromDate provided → AND date >= ?.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * If toDate provided → AND date <= ?.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Order by date ASC, created_at ASC.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Apply LIMIT (default 100 if not provided).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * createTrip:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Enforce user_id (for now always 1 at call site).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Set created_at and updated_at to current ISO time.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Insert and return the full row.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * updateTrip:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Only update fields that are present in input.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Always set updated_at to now.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Return null if no row exists with that id.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * deleteTrip / deleteTripAssignment:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Perform DELETE. It’s OK to be idempotent (no error if row not found).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * listTripAssignmentsByTripId:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * SELECT * FROM trip_assignments WHERE trip_id = ? ORDER BY vehicle ASC, driver_name ASC.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * createTripAssignment / updateTripAssignment:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Similar pattern to createTrip / updateTrip.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Ensure the trip_id exists or rely on foreign key constraints.

________________


2. Backend – Express Routes for Trips & Assignments
Create a new router server/src/routes/trips.ts.
2.1 Validation helpers
Inside trips.ts, add small utilities:
function parseIntParam(value: any): number | null {
  const n = Number(value);
  if (Number.isNaN(n)) return null;
  return n;
}


function isNonEmptyString(value: any): value is string {
  return typeof value === 'string' && value.trim().length > 0;
}


2.2 Routes
Mount these under /api/trips.
GET /api/trips
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Query params:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * from (string, optional) → maps to fromDate.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * to (string, optional) → maps to toDate.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * limit (number, optional).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * includeAssignments (boolean-ish flag, optional) – if truthy ("1", "true", etc.), include assignments.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Call listTrips({ fromDate, toDate, limit }).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * If includeAssignments is set:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * For each trip, call listTripAssignmentsByTripId(trip.id) and attach as assignments array.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Return JSON array of trips, each optionally with assignments.

GET /api/trips/:id
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Parse id from params.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Call getTripById(id).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * If not found → 404 { error: 'Trip not found' }.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Also fetch assignments with listTripAssignmentsByTripId(id) and attach.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Return { ...trip, assignments }.

POST /api/trips
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Expect JSON body:

{
  "date": "2026-01-14",
  "origin": "Bendigo",
  "destination": "Dubbo",
  "notes": "Removalist truck + Josh + Michael"
}


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Validate:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * date, origin, destination are required, non-empty strings.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Assume user_id = 1 for now.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Call createTrip({ user_id: 1, date, origin, destination, notes }).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Return 201 + created trip.

PATCH /api/trips/:id
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Body may include date, origin, destination, notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * If no updatable fields, return 400.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Call updateTrip(id, input).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * If null → 404 { error: 'Trip not found' }.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Return updated trip.

DELETE /api/trips/:id
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * deleteTrip(id).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Return 204 No Content.

________________


2.3 Nested routes for TripAssignments
Still in trips.ts, handle nested assignment routes.
GET /api/trips/:id/assignments
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Ensure trip exists (getTripById).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * If not found → 404.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Else return listTripAssignmentsByTripId(id).

POST /api/trips/:id/assignments
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Ensure trip exists.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * JSON body:

{
  "vehicle": "Rental truck",
  "driver_name": "Josh",
  "passengers": "Michael",
  "cargo_notes": "Furniture, boxes",
  "misc_notes": "Leave by 7am"
}


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Validate vehicle and driver_name as required non-empty strings.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Use trip_id from route param.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Call createTripAssignment({ trip_id, ... }).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Return 201 + created assignment.

PATCH /api/trips/:id/assignments/:assignmentId
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Optionally, you may ignore the :id equality check and just operate on assignmentId, or validate that the assignment belongs to the trip. For simplicity:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Ensure trip exists.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Parse assignmentId.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Body may contain vehicle, driver_name, passengers, cargo_notes, misc_notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Call updateTripAssignment(assignmentId, input).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * If null → 404 { error: 'Assignment not found' }.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Return updated assignment.

DELETE /api/trips/:id/assignments/:assignmentId
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Ensure trip exists.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Call deleteTripAssignment(assignmentId).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Return 204 No Content.

2.4 Mount in app.ts
In server/src/app.ts:
import tripsRouter from './routes/trips';


// ...
app.use('/api/trips', tripsRouter);


Ensure existing routes (/api/health, /api/domains, /api/tasks, /api/documents) still work.
________________


3. Frontend – Types & API Helpers for Trips
Work in client/.
3.1 Types
In client/src/types/api.ts, add:
export interface Trip {
  id: number;
  user_id: number;
  date: string;
  origin: string;
  destination: string;
  notes: string | null;
  created_at: string;
  updated_at: string;
  assignments?: TripAssignment[]; // present when fetched with includeAssignments
}


export interface TripAssignment {
  id: number;
  trip_id: number;
  vehicle: string;
  driver_name: string;
  passengers: string | null;
  cargo_notes: string | null;
  misc_notes: string | null;
  created_at: string;
  updated_at: string;
}


3.2 API helpers
Create client/src/api/trips.ts:
import { apiRequest } from './client';
import type { Trip, TripAssignment } from '../types/api';


export interface ListTripsParams {
  from?: string;
  to?: string;
  limit?: number;
  includeAssignments?: boolean;
}


export async function fetchTrips(params: ListTripsParams = {}): Promise<Trip[]> {
  const searchParams = new URLSearchParams();
  if (params.from) searchParams.set('from', params.from);
  if (params.to) searchParams.set('to', params.to);
  if (params.limit != null) searchParams.set('limit', String(params.limit));
  if (params.includeAssignments) searchParams.set('includeAssignments', '1');


  const query = searchParams.toString();
  const path = query ? `/api/trips?${query}` : '/api/trips';
  return apiRequest<Trip[]>(path);
}


export async function fetchTrip(id: number, includeAssignments = true): Promise<Trip> {
  const path = includeAssignments ? `/api/trips/${id}?includeAssignments=1` : `/api/trips/${id}`;
  // If you didn't implement the query param on backend, just call `/api/trips/${id}`.
  return apiRequest<Trip>(path);
}


export interface CreateTripPayload {
  date: string;
  origin: string;
  destination: string;
  notes?: string;
}


export async function createTrip(payload: CreateTripPayload): Promise<Trip> {
  return apiRequest<Trip>('/api/trips', {
    method: 'POST',
    body: JSON.stringify(payload),
  });
}


export interface UpdateTripPayload {
  date?: string;
  origin?: string;
  destination?: string;
  notes?: string | null;
}


export async function updateTrip(id: number, payload: UpdateTripPayload): Promise<Trip> {
  return apiRequest<Trip>(`/api/trips/${id}`, {
    method: 'PATCH',
    body: JSON.stringify(payload),
  });
}


export async function deleteTrip(id: number): Promise<void> {
  return apiRequest<void>(`/api/trips/${id}`, {
    method: 'DELETE',
  });
}


// Assignments
export interface CreateTripAssignmentPayload {
  vehicle: string;
  driver_name: string;
  passengers?: string;
  cargo_notes?: string;
  misc_notes?: string;
}


export interface UpdateTripAssignmentPayload {
  vehicle?: string;
  driver_name?: string;
  passengers?: string | null;
  cargo_notes?: string | null;
  misc_notes?: string | null;
}


export async function createTripAssignment(
  tripId: number,
  payload: CreateTripAssignmentPayload
): Promise<TripAssignment> {
  return apiRequest<TripAssignment>(`/api/trips/${tripId}/assignments`, {
    method: 'POST',
    body: JSON.stringify(payload),
  });
}


export async function updateTripAssignment(
  tripId: number,
  assignmentId: number,
  payload: UpdateTripAssignmentPayload
): Promise<TripAssignment> {
  return apiRequest<TripAssignment>(`/api/trips/${tripId}/assignments/${assignmentId}`, {
    method: 'PATCH',
    body: JSON.stringify(payload),
  });
}


export async function deleteTripAssignment(tripId: number, assignmentId: number): Promise<void> {
  return apiRequest<void>(`/api/trips/${tripId}/assignments/${assignmentId}`, {
    method: 'DELETE',
  });
}


________________


4. Frontend – Move Plan / Logistics Page
Add a new route /move-plan to the app.
4.1 App routing
In client/src/App.tsx:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Add a nav link “Move Plan”.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Add <Route path="/move-plan" element={<MovePlanPage />} />.

Create client/src/pages/MovePlanPage.tsx.
This page will show:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * A list/timeline of trips (sorted by date).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * The people/vehicle matrix for the selected trip.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * A small list of packing/logistics tasks (domain slug: packing_logistics).

4.2 MovePlanPage structure
State:
const [trips, setTrips] = useState<Trip[]>([]);
const [selectedTripId, setSelectedTripId] = useState<number | null>(null);
const [loadingTrips, setLoadingTrips] = useState(false);
const [error, setError] = useState<string | null>(null);


// For create/edit forms
const [isTripFormOpen, setIsTripFormOpen] = useState(false);
const [tripFormMode, setTripFormMode] = useState<'create' | 'edit'>('create');
const [editingTrip, setEditingTrip] = useState<Trip | null>(null);


const [packingTasks, setPackingTasks] = useState<Task[]>([]);
const [loadingTasks, setLoadingTasks] = useState(false);


Effects:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * On mount:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Fetch trips via fetchTrips({ includeAssignments: true }).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Set the earliest trip as selected by default, if any.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Fetch packing/logistics tasks using existing fetchTasks({ domainSlug: 'packing_logistics' }).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Whenever trips change and there is no selectedTripId, default to the first trip.

Handlers:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * loadTrips: encapsulate fetch logic for reuse after create/update/delete.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * handleSelectTrip(tripId: number).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * handleOpenCreateTrip(): set tripFormMode='create', editingTrip=null, isTripFormOpen=true.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * handleOpenEditTrip(trip: Trip): set mode to edit, editingTrip=trip.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * handleSubmitTrip(formData): use createTrip or updateTrip accordingly, then loadTrips() and close form.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * handleDeleteTrip(trip: Trip): confirm then deleteTrip(trip.id) and refresh; adjust selected trip if needed.

For assignments:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * handleAddAssignment → open a small inline form to create a new assignment for selected trip.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * handleUpdateAssignment → inline editing or small modal; call updateTripAssignment.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * handleDeleteAssignment → call deleteTripAssignment.

4.3 Components
Create components in client/src/components/:
TripList.tsx
Props:
interface TripListProps {
  trips: Trip[];
  selectedTripId: number | null;
  onSelectTrip: (trip: Trip) => void;
  onEditTrip: (trip: Trip) => void;
  onDeleteTrip: (trip: Trip) => void;
}


Behaviour:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Group trips by date (e.g. show date headings with all trips that share that date).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * For each trip show:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Origin → Destination

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Notes (short)

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Highlight the selected trip.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Provide small “Edit” and “Delete” buttons.

TripFormModal.tsx
Props:
interface TripFormModalProps {
  open: boolean;
  mode: 'create' | 'edit';
  initialTrip?: Trip | null;
  onCancel: () => void;
  onSubmit: (data: { date: string; origin: string; destination: string; notes?: string }) => void;
}


Behaviour:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * If open false → render null.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Otherwise show overlay with:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Date input (type="date")

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Origin input

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Destination input

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Notes textarea

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Pre-fill fields if mode === 'edit'.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * On submit:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Validate required fields.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Call onSubmit.

TripAssignmentsTable.tsx
Props:
interface TripAssignmentsTableProps {
  trip: Trip | null;
  onAdd: (data: { vehicle: string; driver_name: string; passengers?: string; cargo_notes?: string; misc_notes?: string }) => void;
  onUpdate: (assignment: TripAssignment, data: UpdateTripAssignmentPayload) => void;
  onDelete: (assignment: TripAssignment) => void;
}


Behaviour:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * If trip is null → show “Select a trip to see assignments”.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * If trip is not null:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Render a small table listing assignments:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Vehicle, Driver, Passengers, Cargo, Notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * For each row:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * “Edit” button – could allow inline editing or pop up a small form.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * “Delete” button – call onDelete.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * At bottom: “Add Assignment” form with fields:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Vehicle, Driver name, Passengers, Cargo notes, Misc notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * On submit, call onAdd.

Keep editing simple – e.g. when “Edit” is clicked, toggle that row into editable inputs with a “Save” button.
Optional: PackingTasksSummary.tsx
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Use existing Task type from client/src/types/api.ts.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Props:

interface PackingTasksSummaryProps {
  tasks: Task[];
  loading: boolean;
  onToggleStatus: (task: Task) => void;
}


Behaviour:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Show a small list (or table) of tasks in the packing_logistics domain:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Show title, status, due date.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Let the user click a checkbox or button to toggle pending <-> done by calling updateTask (reuse from CT4).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * You can import fetchTasks, updateTask from client/src/api/tasks.ts.

4.4 MovePlanPage layout
In MovePlanPage.tsx, layout:
return (
  <div className="move-plan-page">
    <h1>Move Plan & Logistics</h1>
    {error && <div className="error-banner">{error}</div>}


    <div className="move-plan-layout">
      <aside className="move-plan-sidebar">
        <div className="move-plan-sidebar-header">
          <h2>Trips</h2>
          <button onClick={handleOpenCreateTrip}>+ New Trip</button>
        </div>
        {loadingTrips ? (
          <div>Loading trips...</div>
        ) : (
          <TripList
            trips={trips}
            selectedTripId={selectedTripId}
            onSelectTrip={(t) => setSelectedTripId(t.id)}
            onEditTrip={handleOpenEditTrip}
            onDeleteTrip={handleDeleteTrip}
          />
        )}


        <div className="move-plan-packing-tasks">
          <h3>Packing & Logistics Tasks</h3>
          {/* PackingTasksSummary */}
        </div>
      </aside>


      <section className="move-plan-main">
        <h2>People / Vehicle Matrix</h2>
        <TripAssignmentsTable
          trip={selectedTrip}
          onAdd={handleAddAssignment}
          onUpdate={handleUpdateAssignment}
          onDelete={handleDeleteAssignment}
        />
      </section>
    </div>


    <TripFormModal
      open={isTripFormOpen}
      mode={tripFormMode}
      initialTrip={editingTrip}
      onCancel={() => setIsTripFormOpen(false)}
      onSubmit={handleSubmitTrip}
    />
  </div>
);


Where selectedTrip is derived:
const selectedTrip = trips.find((t) => t.id === selectedTripId) || null;


________________


5. Basic Styling
In client/src/index.css (or a suitable stylesheet), add minimal styles for:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * .move-plan-page

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * .move-plan-layout – flex or grid with sidebar + main.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * .move-plan-sidebar – fixed width (e.g. 320px), scrollable.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * .move-plan-main – main content area.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * .error-banner – contrasting background/text.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Table styles for assignments.

Keep it consistent with existing Tasks/Documents layout.
________________


6. README Update
In the root README.md:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Under UI routes, document:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * /move-plan – Move Plan & Logistics:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Shows move trips (Bendigo ↔ Dubbo legs).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Allows managing who is in which vehicle and what they’re carrying.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Shows packing/logistics tasks from the packing_logistics domain.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Under API overview, add:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * GET /api/trips

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * POST /api/trips

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * GET /api/trips/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * PATCH /api/trips/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * DELETE /api/trips/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * GET /api/trips/:id/assignments

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * POST /api/trips/:id/assignments

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * PATCH /api/trips/:id/assignments/:assignmentId

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * DELETE /api/trips/:id/assignments/:assignmentId

Mention expected JSON shapes briefly.
________________


________________
7. Acceptance Criteria
CT6 is complete when:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    1. npm run dev from the repo root still starts both backend and frontend successfully.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    2. Backend:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * POST /api/trips creates a new trip.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * GET /api/trips returns trips list sorted by date.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * GET /api/trips/:id returns a single trip plus its assignments.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * POST /api/trips/:id/assignments adds an assignment for that trip.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * PATCH and DELETE endpoints work as specified.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          3. Frontend:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Visiting http://localhost:3000/move-plan:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Shows a list of trips on the left.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Allows creating/editing/deleting trips.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * When selecting a trip, shows a people/vehicle matrix (assignments) on the right.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Allows adding/editing/removing assignments.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Shows a simple packing/logistics task list (read or interactive) pulled from the packing_logistics domain.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   4. All new code is TypeScript-clean (no type errors) and behaves reasonably on a laptop and phone-width viewport.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   5. Existing routes and features (health check, tasks, documents) still work.

Please output all new/changed files in full (TS, TSX, CSS, route files), with correct imports/exports, so I can paste them into the project and immediately use the Move Plan & Logistics module.
________________


CT7 – Comparison Dashboards for Housing, Kristy’s Work & Childcare (Backend + Frontend)


You are an expert full-stack TypeScript engineer.


The existing `pdm-parris-dubbo-mover` project already has:


- Backend (`server/`):
  - Node + Express + TypeScript.
  - SQLite schema from CT2, including tables:
    - `properties` (Dubbo rentals + Bendigo home),
    - `job_options` (Kristy’s job options),
    - `childcare_options` (Elias & Sylvie daycare/preschool paths),
    - `providers`, `tasks`, `domains`, etc.
  - DB helpers and REST APIs for:
    - `/api/domains`
    - `/api/tasks`
    - `/api/documents`
    - `/api/trips` (and nested assignments).
- Frontend (`client/`):
  - React + TS + Vite.
  - App shell + nav (`Dashboard`, `Tasks`, `Documents`, `Move Plan`).
  - Tasks UI (domains + tasks).
  - Documents UI.
  - Move Plan / Trips & people–vehicle matrix.


Do **not** break anything that already works.


Your job in CT7: build **comparison dashboards** for three critical areas:


1. **Housing & Rentals** (Bendigo home + Dubbo rental candidates)
2. **Kristy’s Work & Career options**
3. **Childcare & Schooling for Elias & Sylvie**


This includes:


- Backend REST APIs for `properties`, `job_options`, and `childcare_options`.
- Frontend pages that let Josh:
  - View all options in each domain.
  - Add/edit/delete options.
  - Compare them in a clear table, with simple derived metrics.
  - See domain-specific tasks alongside (from the `tasks` table).


Think of this as the “planning & decision-support” layer before the later “What next?” engine.


---


## 1. Backend – Types & Query Helpers for Properties, Jobs, Childcare


Work in `server/`.


### 1.1 Types (entities)


In `server/src/types/entities.ts`, ensure these match the actual schema from CT2. If they don’t exist yet, add them.


```ts
export interface Property {
  id: number;
  user_id: number;
  address: string;
  type: string;          // e.g. 'bendigo_home', 'dubbo_rental_candidate', 'dubbo_rental_confirmed'
  rent_weekly: number | null;
  status: string | null; // e.g. 'interested', 'applied', 'secured', 'handed_over'
  notes: string | null;
  created_at: string;
  updated_at: string;
}


export interface JobOption {
  id: number;
  user_id: number;
  employer: string;
  role: string | null;
  hours_per_week: number | null;
  pay_rate_hourly: number | null;
  status: string | null; // 'idea', 'applied', 'offer', 'accepted', 'rejected'
  pros: string | null;
  cons: string | null;
  notes: string | null;
  created_at: string;
  updated_at: string;
}


export interface ChildcareOption {
  id: number;
  user_id: number;
  name: string;
  type: string;               // 'daycare', 'preschool', 'combined', etc.
  location: string | null;
  min_age_months: number | null;
  max_age_months: number | null;
  daily_fee: number | null;
  status: string | null;      // 'idea', 'waitlisted', 'offered', 'enrolled', 'rejected'
  notes: string | null;
  created_at: string;
  updated_at: string;
}


Create DTO types (in the same file or a dtos.ts):
export interface NewPropertyInput {
  user_id: number;
  address: string;
  type: string;
  rent_weekly?: number | null;
  status?: string | null;
  notes?: string | null;
}


export interface UpdatePropertyInput {
  address?: string;
  type?: string;
  rent_weekly?: number | null;
  status?: string | null;
  notes?: string | null;
}


export interface NewJobOptionInput {
  user_id: number;
  employer: string;
  role?: string | null;
  hours_per_week?: number | null;
  pay_rate_hourly?: number | null;
  status?: string | null;
  pros?: string | null;
  cons?: string | null;
  notes?: string | null;
}


export interface UpdateJobOptionInput {
  employer?: string;
  role?: string | null;
  hours_per_week?: number | null;
  pay_rate_hourly?: number | null;
  status?: string | null;
  pros?: string | null;
  cons?: string | null;
  notes?: string | null;
}


export interface NewChildcareOptionInput {
  user_id: number;
  name: string;
  type: string;
  location?: string | null;
  min_age_months?: number | null;
  max_age_months?: number | null;
  daily_fee?: number | null;
  status?: string | null;
  notes?: string | null;
}


export interface UpdateChildcareOptionInput {
  name?: string;
  type?: string;
  location?: string | null;
  min_age_months?: number | null;
  max_age_months?: number | null;
  daily_fee?: number | null;
  status?: string | null;
  notes?: string | null;
}


Make sure column names align with your actual CREATE TABLE statements.
1.2 DB helpers in server/src/db/queries.ts
Extend queries.ts with typed helper functions.
Imports:
import type {
  Property,
  JobOption,
  ChildcareOption,
  NewPropertyInput,
  UpdatePropertyInput,
  NewJobOptionInput,
  UpdateJobOptionInput,
  NewChildcareOptionInput,
  UpdateChildcareOptionInput,
} from '../types/entities';


Properties
export interface ListPropertiesParams {
  type?: string;    // filter by type (e.g. 'dubbo_rental_candidate')
  status?: string;  // filter by status
  limit?: number;
}


export async function listProperties(params: ListPropertiesParams = {}): Promise<Property[]>;


export async function getPropertyById(id: number): Promise<Property | null>;


export async function createProperty(input: NewPropertyInput): Promise<Property>;


export async function updateProperty(id: number, input: UpdatePropertyInput): Promise<Property | null>;


export async function deleteProperty(id: number): Promise<void>;


Implementation:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * listProperties:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Start from SELECT * FROM properties WHERE user_id = ? (use user_id = 1 for now at call site).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Add optional AND type = ? and/or AND status = ?.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * ORDER BY type ASC, status ASC, created_at DESC.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Apply LIMIT (default 100).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * createProperty:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Set created_at and updated_at to current ISO time.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Insert and return full row.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * updateProperty:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Only update provided fields.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Always update updated_at.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Return null if no row.

Job Options
export interface ListJobOptionsParams {
  status?: string;
  limit?: number;
}


export async function listJobOptions(params: ListJobOptionsParams = {}): Promise<JobOption[]>;


export async function getJobOptionById(id: number): Promise<JobOption | null>;


export async function createJobOption(input: NewJobOptionInput): Promise<JobOption>;


export async function updateJobOption(id: number, input: UpdateJobOptionInput): Promise<JobOption | null>;


export async function deleteJobOption(id: number): Promise<void>;


Implementation is similar: filter by status, order by status, created_at DESC.
Childcare Options
export interface ListChildcareOptionsParams {
  type?: string;
  status?: string;
  limit?: number;
}


export async function listChildcareOptions(
  params: ListChildcareOptionsParams = {}
): Promise<ChildcareOption[]>;


export async function getChildcareOptionById(id: number): Promise<ChildcareOption | null>;


export async function createChildcareOption(
  input: NewChildcareOptionInput
): Promise<ChildcareOption>;


export async function updateChildcareOption(
  id: number,
  input: UpdateChildcareOptionInput
): Promise<ChildcareOption | null>;


export async function deleteChildcareOption(id: number): Promise<void>;


Implementation:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Filter by type and status if provided.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Order by type ASC, status ASC, name ASC.

All functions should use getDb() and wrap DB calls in async functions (even if DB is synchronous via better-sqlite3).
________________


2. Backend – REST APIs for Properties, Job Options, Childcare
Create three route files in server/src/routes/:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * properties.ts

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * jobOptions.ts

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * childcareOptions.ts

Each follows the same CRUD pattern as tasks and trips.
2.1 Shared helper
In each route file, you can define small helpers:
function parseLimit(queryValue: any, defaultValue = 100): number {
  if (queryValue === undefined) return defaultValue;
  const n = Number(queryValue);
  return Number.isNaN(n) ? defaultValue : n;
}


function isNonEmptyString(value: any): value is string {
  return typeof value === 'string' && value.trim().length > 0;
}


2.2 Properties Routes – /api/properties
In server/src/routes/properties.ts:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * GET /api/properties

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Query params:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * type (string, optional)

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * status (string, optional)

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * limit (number, optional)

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Call listProperties({ type, status, limit }) with user_id assumed in the helper (or filtered later).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Return array of properties.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * GET /api/properties/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Call getPropertyById.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * If not found → 404 { error: 'Property not found' }.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * POST /api/properties

Body JSON:

{
  "address": "123 Example St, Dubbo",
  "type": "dubbo_rental_candidate",
  "rent_weekly": 580,
  "status": "interested",
  "notes": "4-bed, near DCS"
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   *                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Required: address, type.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Optional: rent_weekly, status, notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Use user_id = 1.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Call createProperty.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Return 201 + created property.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * PATCH /api/properties/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Body may include address, type, rent_weekly, status, notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * If nothing to update → 400.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Call updateProperty; if null → 404.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Return updated property.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * DELETE /api/properties/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Call deleteProperty(id).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Return 204.

2.3 Job Options Routes – /api/job-options
In server/src/routes/jobOptions.ts:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * GET /api/job-options

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Query params: status, limit.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Call listJobOptions({ status, limit }).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * GET /api/job-options/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * POST /api/job-options

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Required: employer (string).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Optional: role, hours_per_week, pay_rate_hourly, status, pros, cons, notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * user_id = 1.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * PATCH /api/job-options/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * DELETE /api/job-options/:id

Make sure to validate numeric fields (if provided) – e.g. if hours_per_week is a string, parse with Number().
2.4 Childcare Options Routes – /api/childcare-options
In server/src/routes/childcareOptions.ts:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * GET /api/childcare-options

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Query params: type, status, limit.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * GET /api/childcare-options/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * POST /api/childcare-options

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Required: name, type.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Optional: location, min_age_months, max_age_months, daily_fee, status, notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * user_id = 1.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * PATCH /api/childcare-options/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * DELETE /api/childcare-options/:id

2.5 Mount in app.ts
In server/src/app.ts:
import propertiesRouter from './routes/properties';
import jobOptionsRouter from './routes/jobOptions';
import childcareOptionsRouter from './routes/childcareOptions';


// ...
app.use('/api/properties', propertiesRouter);
app.use('/api/job-options', jobOptionsRouter);
app.use('/api/childcare-options', childcareOptionsRouter);


Ensure existing imports and error-handling remain intact.
________________


3. Frontend – Shared Types & API Helpers
Work in client/.
3.1 Types
In client/src/types/api.ts, add:
export interface Property {
  id: number;
  user_id: number;
  address: string;
  type: string;
  rent_weekly: number | null;
  status: string | null;
  notes: string | null;
  created_at: string;
  updated_at: string;
}


export interface JobOption {
  id: number;
  user_id: number;
  employer: string;
  role: string | null;
  hours_per_week: number | null;
  pay_rate_hourly: number | null;
  status: string | null;
  pros: string | null;
  cons: string | null;
  notes: string | null;
  created_at: string;
  updated_at: string;
}


export interface ChildcareOption {
  id: number;
  user_id: number;
  name: string;
  type: string;
  location: string | null;
  min_age_months: number | null;
  max_age_months: number | null;
  daily_fee: number | null;
  status: string | null;
  notes: string | null;
  created_at: string;
  updated_at: string;
}


3.2 API helpers
Create client/src/api/properties.ts:
import { apiRequest } from './client';
import type { Property } from '../types/api';


export interface ListPropertiesParams {
  type?: string;
  status?: string;
  limit?: number;
}


export async function fetchProperties(params: ListPropertiesParams = {}): Promise<Property[]> {
  const sp = new URLSearchParams();
  if (params.type) sp.set('type', params.type);
  if (params.status) sp.set('status', params.status);
  if (params.limit != null) sp.set('limit', String(params.limit));
  const qs = sp.toString();
  const path = qs ? `/api/properties?${qs}` : '/api/properties';
  return apiRequest<Property[]>(path);
}


export async function createProperty(payload: {
  address: string;
  type: string;
  rent_weekly?: number | null;
  status?: string | null;
  notes?: string | null;
}): Promise<Property> {
  return apiRequest<Property>('/api/properties', {
    method: 'POST',
    body: JSON.stringify(payload),
  });
}


export async function updateProperty(
  id: number,
  payload: Partial<{
    address: string;
    type: string;
    rent_weekly: number | null;
    status: string | null;
    notes: string | null;
  }>
): Promise<Property> {
  return apiRequest<Property>(`/api/properties/${id}`, {
    method: 'PATCH',
    body: JSON.stringify(payload),
  });
}


export async function deleteProperty(id: number): Promise<void> {
  return apiRequest<void>(`/api/properties/${id}`, {
    method: 'DELETE',
  });
}


Similarly, create client/src/api/jobOptions.ts and client/src/api/childcareOptions.ts with CRUD functions mapping to /api/job-options and /api/childcare-options.
________________


4. Frontend – Comparison Pages
Add three new routes:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * /housing – Housing & Rentals

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * /kristy-work – Kristy’s Work & Career

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * /childcare – Childcare & Schooling

4.1 App routing
In client/src/App.tsx:
Import pages:

import { HousingPage } from './pages/HousingPage';
import { KristyWorkPage } from './pages/KristyWorkPage';
import { ChildcarePage } from './pages/ChildcarePage';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   *                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Add nav links in header:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * “Housing”

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * “Kristy’s Work”

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * “Childcare”

Add routes:

<Route path="/housing" element={<HousingPage />} />
<Route path="/kristy-work" element={<KristyWorkPage />} />
<Route path="/childcare" element={<ChildcarePage />} />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * 4.2 HousingPage
Create client/src/pages/HousingPage.tsx.
Functionality:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Fetch and display:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * All properties (optionally filter by type).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Tasks in housing domain via fetchTasks({ domainSlug: 'housing' }).

State:
const [properties, setProperties] = useState<Property[]>([]);
const [loading, setLoading] = useState(false);
const [error, setError] = useState<string | null>(null);


const [selectedPropertyId, setSelectedPropertyId] = useState<number | null>(null);


const [housingTasks, setHousingTasks] = useState<Task[]>([]);
const [loadingTasks, setLoadingTasks] = useState(false);


Effects:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * On mount:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * fetchProperties() (no filters initially).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * fetchTasks({ domainSlug: 'housing' }).

Handlers:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * handleAddProperty(formData) → createProperty.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * handleUpdateProperty(property, formData) → updateProperty.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * handleDeleteProperty(property) → confirm & deleteProperty.

Computed fields (client-side, for comparison):
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * For each property:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * isBendigoHome = property.type === 'bendigo_home'.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * isDubboCandidate = property.type === 'dubbo_rental_candidate'.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * isConfirmedDubbo = property.type === 'dubbo_rental_confirmed'.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Display rent_weekly and highlight if within target range (e.g. $500–$600).

UI:
Layout:

<div className="housing-page">
  <h1>Housing & Rentals</h1>
  {error && <div className="error-banner">{error}</div>}


  <div className="housing-layout">
    <section className="housing-main">
      <HousingTable
        properties={properties}
        selectedPropertyId={selectedPropertyId}
        onSelect={setSelectedPropertyId}
        onUpdate={handleUpdateProperty}
        onDelete={handleDeleteProperty}
      />
      <HousingPropertyForm onCreate={handleAddProperty} />
    </section>
    <aside className="housing-sidebar">
      <h2>Housing Tasks</h2>
      <DomainTaskSnippet
        tasks={housingTasks}
        loading={loadingTasks}
        domainSlug="housing"
      />
    </aside>
  </div>
</div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Create components:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * HousingTable.tsx

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Props: properties, selectedPropertyId, onSelect, onUpdate, onDelete.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Render table with columns: Address, Type, Weekly Rent, Status, Notes, Actions (Edit/Delete).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Highlight the confirmed Dubbo rental visually (e.g. bold border or label “Chosen rental”).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * HousingPropertyForm.tsx

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Form inputs: Address, Type (select: bendigo_home / dubbo_rental_candidate / dubbo_rental_confirmed), Weekly rent, Status, Notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * On submit, call onCreate.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Reuse or create DomainTaskSnippet component:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Displays list of tasks (title + status) for a domain.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Allows toggling pending/done using updateTask.

4.3 KristyWorkPage
Create client/src/pages/KristyWorkPage.tsx.
Functionality:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Manage job_options:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Tresillian, NSW Health casual pool, private practice, etc.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Show simple derived metrics:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * approxWeeklyPay = hours_per_week * pay_rate_hourly (if both defined).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Show domain tasks:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * fetchTasks({ domainSlug: 'kristy_work' }).

State similar to Housing:
const [jobOptions, setJobOptions] = useState<JobOption[]>([]);
const [selectedJobId, setSelectedJobId] = useState<number | null>(null);
const [loading, setLoading] = useState(false);
const [error, setError] = useState<string | null>(null);


const [jobTasks, setJobTasks] = useState<Task[]>([]);
const [loadingTasks, setLoadingTasks] = useState(false);


Components:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * JobOptionsTable.tsx

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Columns: Employer, Role, Status, Hours/week, Rate/hr, Approx weekly pay (derived), Pros, Cons, Actions (Edit/Delete).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Highlight rows with status === 'offer' or 'accepted'.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * JobOptionForm.tsx

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Inputs: Employer (required), Role, Hours/week, Rate/hr, Status, Pros, Cons, Notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * On submit, call createJobOption.

Use same DomainTaskSnippet for tasks.
4.4 ChildcarePage
Create client/src/pages/ChildcarePage.tsx.
Functionality:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Manage childcare_options for Elias & Sylvie:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Daycare (likely Elias),

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Preschool (Sylvie: Dubbo Christian + backups),

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Combined services if any.

State:
const [childcareOptions, setChildcareOptions] = useState<ChildcareOption[]>([]);
const [selectedOptionId, setSelectedOptionId] = useState<number | null>(null);
const [loading, setLoading] = useState(false);
const [error, setError] = useState<string | null>(null);


const [childcareTasks, setChildcareTasks] = useState<Task[]>([]);
const [loadingTasks, setLoadingTasks] = useState(false);


Components:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * ChildcareOptionsTable.tsx

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Columns: Name, Type (daycare/preschool/combined), Location, Age range (min–max months), Daily fee, Status, Notes, Actions.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * You can visually annotate rows intended for Elias vs Sylvie by using the notes field (e.g. if notes includes “Elias” or “Sylvie”), but no extra schema is required.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * ChildcareOptionForm.tsx

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Inputs: Name (required), Type (select), Location, Min age, Max age, Daily fee, Status, Notes.

Tasks:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Use fetchTasks({ domainSlug: 'childcare_schooling' }).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Reuse DomainTaskSnippet.

________________


5. Styling
In client/src/index.css (or an appropriate stylesheet):
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Add basic styles for:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * .housing-page, .kristy-work-page, .childcare-page

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * .housing-layout, .kristy-work-layout, .childcare-layout

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Two-column layout: main (tables/forms) + sidebar (tasks).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Tables:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Simple row striping and border.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Highlight rows based on type/status (e.g. confirmed rental, accepted job).

Keep it consistent with styling of TasksPage, DocumentsPage, MovePlanPage.
________________


6. README Update
In root README.md, extend:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * API Overview:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * GET /api/properties / POST /api/properties / PATCH /api/properties/:id / DELETE /api/properties/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * GET /api/job-options / POST /api/job-options / PATCH /api/job-options/:id / DELETE /api/job-options/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * GET /api/childcare-options / POST /api/childcare-options / PATCH /api/childcare-options/:id / DELETE /api/childcare-options/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * UI Routes:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * /housing – Housing & Rentals comparison dashboard.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * /kristy-work – Kristy’s job options comparison dashboard.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * /childcare – Childcare & schooling options dashboard.

Mention that each page shows the relevant options table plus domain-specific tasks.
________________


________________
7. Acceptance Criteria
CT7 is complete when:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1. npm run dev still starts backend + frontend successfully.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 2. Backend:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * POST /api/properties creates a property and GET /api/properties lists it.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * POST /api/job-options creates a job option and GET /api/job-options lists it.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * POST /api/childcare-options creates a childcare option and GET /api/childcare-options lists it.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * PATCH and DELETE endpoints for each resource behave correctly (update/remove).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       3. Frontend:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * /housing:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Shows a table of properties.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Allows creating/editing/deleting properties.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Shows housing-related tasks from the housing domain.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * /kristy-work:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Shows job options with derived weekly pay where possible.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Allows basic CRUD on job options.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Shows tasks from kristy_work domain.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * /childcare:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Shows childcare options with age range, fees, and status.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Allows basic CRUD.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Shows tasks from childcare_schooling domain.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            4. All new TS/TSX compiles without TypeScript errors.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            5. Existing features (health check, tasks, documents, move plan) continue to function as before.

Please output all new/changed backend and frontend files in full (route files, query helpers, type definitions, API clients, pages, and components) so I can paste them into the project and immediately use these comparison dashboards.
CT8 – Health & NDIS Providers + Appointments Dashboard (Backend + Frontend)


You are an expert full-stack TypeScript engineer.


The existing `pdm-parris-dubbo-mover` project already has:


- Backend (`server/`):
  - Node + Express + TypeScript.
  - SQLite schema from CT2, including tables:
    - `providers` (for health / NDIS providers),
    - `tasks`, `domains`, `documents`, `trips`, `properties`, `job_options`, `childcare_options`, etc.
  - DB helpers + REST APIs for:
    - `/api/domains`
    - `/api/tasks`
    - `/api/documents`
    - `/api/trips` (with assignments)
    - `/api/properties`
    - `/api/job-options`
    - `/api/childcare-options`
- Frontend (`client/`):
  - React + TypeScript + Vite.
  - App shell and navigation with routes:
    - `/` (Dashboard)
    - `/tasks`
    - `/documents`
    - `/move-plan`
    - `/housing`
    - `/kristy-work`
    - `/childcare`
  - Domain task snippet components.
- Vite dev server proxy so `/api/...` hits the backend.


Do **not** break existing behaviour.


Your job in CT8: build the **Health & NDIS module**, which lets Josh:


1. Track **providers** for:
   - Kristy’s MS / neurology & Tysabri infusions (Dubbo, Orange, visiting specialists, etc.).
   - Sylvie’s NDIS therapies (OT, speech, child psychologist, early intervention).
   - Family GP and other key health services.


2. Track **appointments** with those providers:
   - Upcoming and past consults, infusions, assessments.
   - Which family member it’s for (Kristy, Sylvie, Josh, Elias).
   - Status (planned, booked, completed, cancelled).


3. See domain-specific tasks alongside:
   - `health_ms` (Kristy’s MS / neurology pipeline).
   - `ndis_therapies` (Sylvie’s NDIS and therapies).


This should result in:


- Backend REST APIs for `providers` and `appointments`.
- A frontend “Health & NDIS” page with:
  - Provider list & CRUD.
  - Appointments list & CRUD.
  - Upcoming appointments view (chronological).
  - Health/NDIS tasks snippet at the side.


---


## 1. Backend – Types & DB Helpers for Providers & Appointments


Work in `server/`.


### 1.1 Entities (confirm or extend schema)


In `server/src/types/entities.ts`, ensure these interfaces exist and match the actual DB schema. If they don’t, add/adjust them.


```ts
export interface Provider {
  id: number;
  user_id: number;
  name: string;
  category: string;        // e.g. 'neurology', 'ms_infusion', 'gp', 'ot', 'speech', 'psych', 'early_intervention'
  organisation: string | null;
  location: string | null; // e.g. "Dubbo Base Hospital", "Psychological Solutions Dubbo"
  phone: string | null;
  email: string | null;
  website: string | null;
  notes: string | null;
  created_at: string;
  updated_at: string;
}


export interface Appointment {
  id: number;
  user_id: number;
  provider_id: number | null;
  person: string;          // 'Kristy', 'Sylvie', 'Josh', 'Elias', etc.
  type: string | null;     // 'consult', 'infusion', 'assessment', 'follow_up', etc.
  starts_at: string;       // ISO datetime string
  ends_at: string | null;  // ISO datetime string or null
  status: string;          // 'planned', 'booked', 'completed', 'cancelled'
  location_override: string | null;
  notes: string | null;
  created_at: string;
  updated_at: string;
}


Define DTO types (same file or dtos.ts):
export interface NewProviderInput {
  user_id: number;
  name: string;
  category: string;
  organisation?: string | null;
  location?: string | null;
  phone?: string | null;
  email?: string | null;
  website?: string | null;
  notes?: string | null;
}


export interface UpdateProviderInput {
  name?: string;
  category?: string;
  organisation?: string | null;
  location?: string | null;
  phone?: string | null;
  email?: string | null;
  website?: string | null;
  notes?: string | null;
}


export interface NewAppointmentInput {
  user_id: number;
  provider_id?: number | null;
  person: string;
  starts_at: string;
  type?: string | null;
  ends_at?: string | null;
  status?: string; // default 'booked'
  location_override?: string | null;
  notes?: string | null;
}


export interface UpdateAppointmentInput {
  provider_id?: number | null;
  person?: string;
  type?: string | null;
  starts_at?: string;
  ends_at?: string | null;
  status?: string;
  location_override?: string | null;
  notes?: string | null;
}


Ensure these match actual DB column names. If CT2 defined slightly different columns, adjust interfaces and DTOs accordingly, but keep the semantics.
1.2 DB helper functions in server/src/db/queries.ts
At the top, import the new types:
import type {
  Provider,
  Appointment,
  NewProviderInput,
  UpdateProviderInput,
  NewAppointmentInput,
  UpdateAppointmentInput,
} from '../types/entities';


Add helper functions:
export interface ListProvidersParams {
  category?: string;
  search?: string;  // search by name or organisation
  limit?: number;
}


export async function listProviders(params: ListProvidersParams = {}): Promise<Provider[]>;


export async function getProviderById(id: number): Promise<Provider | null>;


export async function createProvider(input: NewProviderInput): Promise<Provider>;


export async function updateProvider(id: number, input: UpdateProviderInput): Promise<Provider | null>;


export async function deleteProvider(id: number): Promise<void>;


export interface ListAppointmentsParams {
  person?: string;
  providerId?: number;
  status?: string;
  from?: string; // ISO datetime, inclusive
  to?: string;   // ISO datetime, inclusive
  limit?: number;
}


export async function listAppointments(params: ListAppointmentsParams = {}): Promise<Appointment[]>;


export async function getAppointmentById(id: number): Promise<Appointment | null>;


export async function createAppointment(input: NewAppointmentInput): Promise<Appointment>;


export async function updateAppointment(
  id: number,
  input: UpdateAppointmentInput
): Promise<Appointment | null>;


export async function deleteAppointment(id: number): Promise<void>;


Implementation details:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Use getDb() and PRAGMA foreign_keys = ON.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * listProviders:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * SELECT * FROM providers WHERE user_id = ? (assume 1 at call site).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * If category provided, add AND category = ?.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * If search provided, add AND (name LIKE ? OR organisation LIKE ?) with %search%.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Order by category ASC, name ASC.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Apply LIMIT (default 100 if unset).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * createProvider:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Set created_at and updated_at to current ISO string.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Insert row and return full row.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * updateProvider:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Only update fields present in input.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Always update updated_at.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Return null if no row.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * listAppointments:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * SELECT * FROM appointments WHERE user_id = ?.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Filter:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * person (exact match).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * providerId (if provided).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * status (exact match).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * from → starts_at >= ?.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * to → starts_at <= ?.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Order by starts_at ASC, created_at ASC.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Apply LIMIT (default 200).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * createAppointment:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Default status to 'booked' if not provided.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Set timestamps.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Insert and return full row.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * updateAppointment:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * As above; return null if id not found.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * deleteAppointment:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Idempotent is fine.

________________


2. Backend – Express Routes for Providers & Appointments
Create two new route files:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * server/src/routes/providers.ts

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * server/src/routes/appointments.ts

2.1 Shared utilities
In each route file, define:
function parseLimit(queryValue: any, defaultValue = 100): number {
  if (queryValue === undefined) return defaultValue;
  const n = Number(queryValue);
  return Number.isNaN(n) ? defaultValue : n;
}


function isNonEmptyString(value: any): value is string {
  return typeof value === 'string' && value.trim().length > 0;
}


2.2 Providers routes – /api/providers
In providers.ts:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * GET /api/providers

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Query params: category, search, limit.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Use listProviders({ category, search, limit }).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Return array of providers.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * GET /api/providers/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Use getProviderById(id).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * If not found → 404 { error: 'Provider not found' }.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * POST /api/providers

Expected JSON body:

{
  "name": "Dubbo Neurologist",
  "category": "neurology",
  "organisation": "Dubbo Specialist Centre",
  "location": "Dubbo NSW",
  "phone": "02 5555 5555",
  "email": "neuro@example.com",
  "website": "https://example.com",
  "notes": "Good for Tysabri transfer"
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 *                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Required: name, category.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Optional: organisation, location, phone, email, website, notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Set user_id = 1.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Call createProvider.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Return 201 + created provider.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * PATCH /api/providers/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Body may contain any subset of Provider fields (except ids, timestamps).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * If no updatable fields, return 400.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Call updateProvider.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * If null → 404.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Return updated provider.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * DELETE /api/providers/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * deleteProvider(id); return 204.

2.3 Appointments routes – /api/appointments
In appointments.ts:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * GET /api/appointments

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Query params: person, providerId, status, from, to, limit.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Parse providerId as number if present.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Call listAppointments(params).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Return array of appointments.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * GET /api/appointments/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Use getAppointmentById.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * If not found → 404 { error: 'Appointment not found' }.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * POST /api/appointments

Expected JSON:

{
  "provider_id": 3,
  "person": "Kristy",
  "type": "infusion",
  "starts_at": "2026-01-20T10:00:00",
  "ends_at": "2026-01-20T12:00:00",
  "status": "booked",
  "location_override": "Dubbo Base Hospital",
  "notes": "First Tysabri infusion in Dubbo"
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               *                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Required: person (non-empty), starts_at (non-empty ISO-ish string).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * provider_id is optional and may be null (e.g. phone consult not yet tied to provider).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Optional: type, ends_at, status, location_override, notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Default status to 'booked' if not given.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Use user_id = 1.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Call createAppointment.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Return 201 + created appointment.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * PATCH /api/appointments/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Accept partial updates for any Appointment fields (except ids, timestamps).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * If no updatable fields, return 400.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Call updateAppointment.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * If null → 404.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Return updated appointment.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * DELETE /api/appointments/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Call deleteAppointment(id).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Return 204.

2.4 Mount routes
In server/src/app.ts:
import providersRouter from './routes/providers';
import appointmentsRouter from './routes/appointments';


// ...
app.use('/api/providers', providersRouter);
app.use('/api/appointments', appointmentsRouter);


Ensure error-handling middleware still sits at the bottom.
________________


3. Frontend – Types & API Helpers
Work in client/.
3.1 Types
In client/src/types/api.ts, add:
export interface Provider {
  id: number;
  user_id: number;
  name: string;
  category: string;
  organisation: string | null;
  location: string | null;
  phone: string | null;
  email: string | null;
  website: string | null;
  notes: string | null;
  created_at: string;
  updated_at: string;
}


export interface Appointment {
  id: number;
  user_id: number;
  provider_id: number | null;
  person: string;
  type: string | null;
  starts_at: string;
  ends_at: string | null;
  status: string;
  location_override: string | null;
  notes: string | null;
  created_at: string;
  updated_at: string;
}


3.2 API helpers
Create client/src/api/providers.ts:
import { apiRequest } from './client';
import type { Provider } from '../types/api';


export interface ListProvidersParams {
  category?: string;
  search?: string;
  limit?: number;
}


export async function fetchProviders(params: ListProvidersParams = {}): Promise<Provider[]> {
  const sp = new URLSearchParams();
  if (params.category) sp.set('category', params.category);
  if (params.search) sp.set('search', params.search);
  if (params.limit != null) sp.set('limit', String(params.limit));
  const qs = sp.toString();
  const path = qs ? `/api/providers?${qs}` : '/api/providers';
  return apiRequest<Provider[]>(path);
}


export async function createProvider(payload: {
  name: string;
  category: string;
  organisation?: string | null;
  location?: string | null;
  phone?: string | null;
  email?: string | null;
  website?: string | null;
  notes?: string | null;
}): Promise<Provider> {
  return apiRequest<Provider>('/api/providers', {
    method: 'POST',
    body: JSON.stringify(payload),
  });
}


export async function updateProvider(
  id: number,
  payload: Partial<{
    name: string;
    category: string;
    organisation: string | null;
    location: string | null;
    phone: string | null;
    email: string | null;
    website: string | null;
    notes: string | null;
  }>
): Promise<Provider> {
  return apiRequest<Provider>(`/api/providers/${id}`, {
    method: 'PATCH',
    body: JSON.stringify(payload),
  });
}


export async function deleteProvider(id: number): Promise<void> {
  return apiRequest<void>(`/api/providers/${id}`, {
    method: 'DELETE',
  });
}


Create client/src/api/appointments.ts:
import { apiRequest } from './client';
import type { Appointment } from '../types/api';


export interface ListAppointmentsParams {
  person?: string;
  providerId?: number;
  status?: string;
  from?: string;
  to?: string;
  limit?: number;
}


export async function fetchAppointments(params: ListAppointmentsParams = {}): Promise<Appointment[]> {
  const sp = new URLSearchParams();
  if (params.person) sp.set('person', params.person);
  if (params.providerId != null) sp.set('providerId', String(params.providerId));
  if (params.status) sp.set('status', params.status);
  if (params.from) sp.set('from', params.from);
  if (params.to) sp.set('to', params.to);
  if (params.limit != null) sp.set('limit', String(params.limit));
  const qs = sp.toString();
  const path = qs ? `/api/appointments?${qs}` : '/api/appointments';
  return apiRequest<Appointment[]>(path);
}


export interface CreateAppointmentPayload {
  provider_id?: number | null;
  person: string;
  type?: string;
  starts_at: string;
  ends_at?: string | null;
  status?: string;
  location_override?: string | null;
  notes?: string | null;
}


export async function createAppointment(payload: CreateAppointmentPayload): Promise<Appointment> {
  return apiRequest<Appointment>('/api/appointments', {
    method: 'POST',
    body: JSON.stringify(payload),
  });
}


export interface UpdateAppointmentPayload {
  provider_id?: number | null;
  person?: string;
  type?: string | null;
  starts_at?: string;
  ends_at?: string | null;
  status?: string;
  location_override?: string | null;
  notes?: string | null;
}


export async function updateAppointment(
  id: number,
  payload: UpdateAppointmentPayload
): Promise<Appointment> {
  return apiRequest<Appointment>(`/api/appointments/${id}`, {
    method: 'PATCH',
    body: JSON.stringify(payload),
  });
}


export async function deleteAppointment(id: number): Promise<void> {
  return apiRequest<void>(`/api/appointments/${id}`, {
    method: 'DELETE',
  });
}


________________


4. Frontend – Health & NDIS Dashboard
Add a new route /health-ndis with a page that combines:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Providers list (filterable by category).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Appointments list (upcoming & past).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Quick summary of health-related tasks.

4.1 Routing
In client/src/App.tsx:
Import the page:

import { HealthNdisPage } from './pages/HealthNdisPage';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 *                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Add a nav link in the header: “Health & NDIS”.

Add route:

<Route path="/health-ndis" element={<HealthNdisPage />} />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * 4.2 HealthNdisPage skeleton
Create client/src/pages/HealthNdisPage.tsx.
State:
const [providers, setProviders] = useState<Provider[]>([]);
const [appointments, setAppointments] = useState<Appointment[]>([]);
const [selectedProviderId, setSelectedProviderId] = useState<number | null>(null);
const [filterCategory, setFilterCategory] = useState<string>(''); // e.g. '', 'neurology', 'ot', etc.
const [filterPerson, setFilterPerson] = useState<string>('');     // '', 'Kristy', 'Sylvie', etc.
const [loadingProviders, setLoadingProviders] = useState(false);
const [loadingAppointments, setLoadingAppointments] = useState(false);
const [error, setError] = useState<string | null>(null);


// Tasks for health_ms and ndis_therapies
const [healthTasks, setHealthTasks] = useState<Task[]>([]);
const [ndisTasks, setNdisTasks] = useState<Task[]>([]);
const [loadingTasks, setLoadingTasks] = useState(false);


Effects:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * On mount:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Load providers: fetchProviders({}).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Load appointments for the next ~6 months: fetchAppointments({ from: todayISO, limit: 200 }).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Load tasks:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * fetchTasks({ domainSlug: 'health_ms' }).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * fetchTasks({ domainSlug: 'ndis_therapies' }).

Handler utilities:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * reloadProviders and reloadAppointments to call after create/update/delete.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Filtering:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * When filterCategory is set, you can either:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Re-fetch with fetchProviders({ category: filterCategory }), or

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Filter client-side (simpler).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Similarly for filterPerson and appointments.

Appointments sorting:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Always sort appointments by starts_at ascending when displaying “upcoming”.

4.3 Components
Create components in client/src/components/:
ProviderList.tsx
Props:
interface ProviderListProps {
  providers: Provider[];
  selectedProviderId: number | null;
  onSelect: (provider: Provider) => void;
  onEdit: (provider: Provider) => void;
  onDelete: (provider: Provider) => void;
}


Behaviour:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Render a list/table with columns: Name, Category, Organisation, Location, Phone.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Highlight selected provider.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Include Edit/Delete buttons.

ProviderFormModal.tsx
Props:
interface ProviderFormModalProps {
  open: boolean;
  mode: 'create' | 'edit';
  initialProvider?: Provider | null;
  onCancel: () => void;
  onSubmit: (data: {
    name: string;
    category: string;
    organisation?: string;
    location?: string;
    phone?: string;
    email?: string;
    website?: string;
    notes?: string;
  }) => void;
}


Behaviour:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Show form fields:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Name (required).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Category (select with common values: neurology, ms_infusion, gp, ot, speech, psych, early_intervention, other).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Organisation, location, phone, email, website, notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Pre-fill in edit mode.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Validate name & category.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Call onSubmit.

AppointmentList.tsx
Props:
interface AppointmentListProps {
  appointments: Appointment[];
  providersById: Record<number, Provider>;
  onEdit: (appointment: Appointment) => void;
  onDelete: (appointment: Appointment) => void;
}


Behaviour:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Display table of appointments with columns:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Date/time (format from starts_at).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Person.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Provider name (looked up via providersById[provider_id], fallback to “(Unassigned)”).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Type.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Status.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Location (prefer location_override, otherwise provider.location).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Group upcoming vs past:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Option A: show only upcoming (>= now). Option B: two sections; for CT8, showing upcoming is enough.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Provide Edit/Delete actions.

AppointmentFormModal.tsx
Props:
interface AppointmentFormModalProps {
  open: boolean;
  mode: 'create' | 'edit';
  initialAppointment?: Appointment | null;
  providers: Provider[];
  defaultProviderId?: number | null;
  onCancel: () => void;
  onSubmit: (data: {
    provider_id?: number | null;
    person: string;
    type?: string;
    starts_at: string;
    ends_at?: string | null;
    status?: string;
    location_override?: string | null;
    notes?: string | null;
  }) => void;
}


Behaviour:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Fields:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Provider (select from providers; “None/Not yet chosen” option allowed).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Person (select: Kristy, Sylvie, Josh, Elias, Other).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Type (text input or small select).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Start date/time (two inputs: date + time) that convert to ISO string on submit.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Optional end date/time.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Status (select: planned, booked, completed, cancelled).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Location override.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Notes.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Pre-fill in edit mode; for create, use defaultProviderId if provided.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Validate:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Person non-empty.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Start date/time present.

DomainTaskSnippet.tsx (if not already built)
If an equivalent component already exists from CT6/CT7, reuse it. Otherwise create:
interface DomainTaskSnippetProps {
  title: string;
  tasks: Task[];
  loading: boolean;
  onToggleStatus: (task: Task) => void;
}


Behaviour:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Show a small list of tasks:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Title, status.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Checkbox or button to toggle pending <-> done.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Use updateTask(task.id, { status: newStatus }).

4.4 HealthNdisPage layout & wiring
In HealthNdisPage.tsx, glue everything together:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Local state for:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Provider form modal open/closed + mode + editing provider.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Appointment form modal open/closed + mode + editing appointment.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Handlers:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * handleCreateProvider:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Open provider form in create mode.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * handleSubmitProvider:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Call createProvider or updateProvider.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Then reload providers and close modal.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * handleDeleteProvider:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Confirm, then deleteProvider and reload; if the deleted provider was selectedProviderId, clear selection.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * handleCreateAppointment:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Open appointment form in create mode, possibly with defaultProviderId = selectedProviderId.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * handleSubmitAppointment:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Call createAppointment or updateAppointment.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Reload appointments; close modal.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * handleDeleteAppointment:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Confirm, then deleteAppointment.

Build a lookup map for providers:

const providersById = useMemo(
  () =>
    providers.reduce<Record<number, Provider>>((acc, p) => {
      acc[p.id] = p;
      return acc;
    }, {}),
  [providers]
);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Layout:
return (
  <div className="health-ndis-page">
    <h1>Health & NDIS</h1>
    {error && <div className="error-banner">{error}</div>}


    <div className="health-ndis-layout">
      <aside className="health-ndis-sidebar">
        <div className="health-ndis-providers-header">
          <h2>Providers</h2>
          <button onClick={handleOpenCreateProvider}>+ New Provider</button>
        </div>
        <div className="health-ndis-filters">
          <label>
            Category:
            <select value={filterCategory} onChange={(e) => setFilterCategory(e.target.value)}>
              <option value="">All</option>
              <option value="neurology">Neurology</option>
              <option value="ms_infusion">MS Infusion</option>
              <option value="gp">GP</option>
              <option value="ot">OT</option>
              <option value="speech">Speech</option>
              <option value="psych">Psych</option>
              <option value="early_intervention">Early intervention</option>
              <option value="other">Other</option>
            </select>
          </label>
        </div>
        <ProviderList
          providers={filteredProviders}
          selectedProviderId={selectedProviderId}
          onSelect={(p) => setSelectedProviderId(p.id)}
          onEdit={handleOpenEditProvider}
          onDelete={handleDeleteProvider}
        />


        <div className="health-ndis-tasks">
          <h3>Kristy – MS / Neurology Tasks</h3>
          <DomainTaskSnippet
            title="Health (MS)"
            tasks={healthTasks}
            loading={loadingTasks}
            onToggleStatus={handleToggleTaskStatus}
          />
          <h3>Sylvie – NDIS / Therapies Tasks</h3>
          <DomainTaskSnippet
            title="NDIS / Therapies"
            tasks={ndisTasks}
            loading={loadingTasks}
            onToggleStatus={handleToggleTaskStatus}
          />
        </div>
      </aside>


      <section className="health-ndis-main">
        <div className="appointments-header">
          <h2>Appointments</h2>
          <div className="appointments-filters">
            <label>
              Person:
              <select value={filterPerson} onChange={(e) => setFilterPerson(e.target.value)}>
                <option value="">All</option>
                <option value="Kristy">Kristy</option>
                <option value="Sylvie">Sylvie</option>
                <option value="Josh">Josh</option>
                <option value="Elias">Elias</option>
              </select>
            </label>
            <button onClick={handleOpenCreateAppointment}>+ New Appointment</button>
          </div>
        </div>


        <AppointmentList
          appointments={filteredAppointments}
          providersById={providersById}
          onEdit={handleOpenEditAppointment}
          onDelete={handleDeleteAppointment}
        />
      </section>
    </div>


    <ProviderFormModal
      open={isProviderFormOpen}
      mode={providerFormMode}
      initialProvider={editingProvider}
      onCancel={() => setIsProviderFormOpen(false)}
      onSubmit={handleSubmitProvider}
    />


    <AppointmentFormModal
      open={isAppointmentFormOpen}
      mode={appointmentFormMode}
      initialAppointment={editingAppointment}
      providers={providers}
      defaultProviderId={selectedProviderId ?? undefined}
      onCancel={() => setIsAppointmentFormOpen(false)}
      onSubmit={handleSubmitAppointment}
    />
  </div>
);


Where filteredProviders/filteredAppointments apply current filters.
________________


5. Styling
In client/src/index.css (or relevant stylesheet), add:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * .health-ndis-page

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * .health-ndis-layout – two-column flex or grid:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Sidebar ~320px width, scrollable.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Main area flexible.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * .health-ndis-sidebar, .health-ndis-main

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * .health-ndis-providers-header, .appointments-header

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * .error-banner (if not already defined).

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Basic styles for tables/lists in ProviderList and AppointmentList.

Keep visual style matching other pages (Tasks, Documents, Move Plan).
________________


6. README Update
In the root README.md:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Under API Overview, document:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * GET /api/providers

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * POST /api/providers

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * GET /api/providers/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * PATCH /api/providers/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DELETE /api/providers/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * GET /api/appointments

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * POST /api/appointments

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * GET /api/appointments/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * PATCH /api/appointments/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DELETE /api/appointments/:id

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Under UI Routes, add:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * /health-ndis – Health & NDIS dashboard:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Manage health / NDIS providers.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Manage appointments for Kristy, Sylvie, Josh, Elias.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              * Show MS and NDIS-related tasks.

________________


7. Acceptance Criteria
CT8 is complete when:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1. npm run dev still starts backend and frontend successfully.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 2. Backend:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * POST /api/providers creates a provider and GET /api/providers lists it.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * POST /api/appointments creates an appointment and GET /api/appointments lists it ordered by starts_at.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * Query filters (category, search, person, status, from, to) behave as expected.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    * PATCH and DELETE endpoints for providers and appointments work correctly.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       3. Frontend:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Visiting http://localhost:3000/health-ndis:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Shows provider list with filters and allows creating/editing/deleting providers.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Shows appointments sorted by date/time, filterable by person.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Allows creating/editing/deleting appointments.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Shows two task snippets: one for health_ms, one for ndis_therapies, with ability to toggle task status.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                4. All new TypeScript code (backend & frontend) compiles without errors.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                5. Existing features (health check, tasks, documents, move plan, comparison dashboards) continue to function.

Please output all new/changed backend and frontend files in full (route files, query helpers, type definitions, API clients, pages, and components) so I can paste them into the project and immediately use the Health & NDIS module.